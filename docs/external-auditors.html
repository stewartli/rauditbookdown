<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 External Auditors | Data Analytics in R</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 External Auditors | Data Analytics in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/img/cover.jpg" />
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 External Auditors | Data Analytics in R" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="twitter:image" content="/img/cover.jpg" />

<meta name="author" content="Stewart Li" />


<meta name="date" content="2021-11-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="fpa.html"/>
<link rel="next" href="utilities.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.17/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<script src="libs/d3-4.10.2/d3.min.js"></script>
<link href="libs/collapsibleTree-0.1.6/collapsibleTree.css" rel="stylesheet" />
<script src="libs/collapsibleTree-binding-0.1.7/collapsibleTree.js"></script>
<link href="libs/wordcloud2-0.0.1/wordcloud.css" rel="stylesheet" />
<script src="libs/wordcloud2-0.0.1/wordcloud2-all.js"></script>
<script src="libs/wordcloud2-0.0.1/hover.js"></script>
<script src="libs/wordcloud2-binding-0.2.1/wordcloud2.js"></script>
<link href="libs/table1-1.0/table1_defaults.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analytics in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intror.html"><a href="intror.html"><i class="fa fa-check"></i><b>2</b> R basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intror.html"><a href="intror.html#setup"><i class="fa fa-check"></i><b>2.1</b> Setup</a></li>
<li class="chapter" data-level="2.2" data-path="intror.html"><a href="intror.html#help"><i class="fa fa-check"></i><b>2.2</b> Help</a></li>
<li class="chapter" data-level="2.3" data-path="intror.html"><a href="intror.html#variable"><i class="fa fa-check"></i><b>2.3</b> Variable</a></li>
<li class="chapter" data-level="2.4" data-path="intror.html"><a href="intror.html#data-structure"><i class="fa fa-check"></i><b>2.4</b> Data structure</a></li>
<li class="chapter" data-level="2.5" data-path="intror.html"><a href="intror.html#control-flow"><i class="fa fa-check"></i><b>2.5</b> Control flow</a></li>
<li class="chapter" data-level="2.6" data-path="intror.html"><a href="intror.html#function"><i class="fa fa-check"></i><b>2.6</b> Function</a></li>
<li class="chapter" data-level="2.7" data-path="intror.html"><a href="intror.html#oop"><i class="fa fa-check"></i><b>2.7</b> OOP</a></li>
<li class="chapter" data-level="2.8" data-path="intror.html"><a href="intror.html#io"><i class="fa fa-check"></i><b>2.8</b> IO</a></li>
<li class="chapter" data-level="2.9" data-path="intror.html"><a href="intror.html#system"><i class="fa fa-check"></i><b>2.9</b> System</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>3</b> Import</a>
<ul>
<li class="chapter" data-level="3.1" data-path="import.html"><a href="import.html#dataset"><i class="fa fa-check"></i><b>3.1</b> Dataset</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="import.html"><a href="import.html#data-to-database"><i class="fa fa-check"></i><b>3.1.1</b> Data to database</a></li>
<li class="chapter" data-level="3.1.2" data-path="import.html"><a href="import.html#data-model"><i class="fa fa-check"></i><b>3.1.2</b> Data model</a></li>
<li class="chapter" data-level="3.1.3" data-path="import.html"><a href="import.html#join-tables"><i class="fa fa-check"></i><b>3.1.3</b> Join tables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="import.html"><a href="import.html#sqlite"><i class="fa fa-check"></i><b>3.2</b> SQLite</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="import.html"><a href="import.html#connection"><i class="fa fa-check"></i><b>3.2.1</b> Connection</a></li>
<li class="chapter" data-level="3.2.2" data-path="import.html"><a href="import.html#r-code-chunk"><i class="fa fa-check"></i><b>3.2.2</b> R code chunk</a></li>
<li class="chapter" data-level="3.2.3" data-path="import.html"><a href="import.html#sql-code-chunk"><i class="fa fa-check"></i><b>3.2.3</b> SQL code chunk</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="fpa.html"><a href="fpa.html"><i class="fa fa-check"></i><b>4</b> FP&amp;A</a>
<ul>
<li class="chapter" data-level="4.1" data-path="fpa.html"><a href="fpa.html#validation"><i class="fa fa-check"></i><b>4.1</b> Validation</a></li>
<li class="chapter" data-level="4.2" data-path="fpa.html"><a href="fpa.html#eda"><i class="fa fa-check"></i><b>4.2</b> EDA</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="fpa.html"><a href="fpa.html#categorical"><i class="fa fa-check"></i><b>4.2.1</b> Categorical</a></li>
<li class="chapter" data-level="4.2.2" data-path="fpa.html"><a href="fpa.html#numeric"><i class="fa fa-check"></i><b>4.2.2</b> Numeric</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="fpa.html"><a href="fpa.html#business-ananlysis"><i class="fa fa-check"></i><b>4.3</b> Business ananlysis</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="fpa.html"><a href="fpa.html#product-profit-margin"><i class="fa fa-check"></i><b>4.3.1</b> Product profit margin</a></li>
<li class="chapter" data-level="4.3.2" data-path="fpa.html"><a href="fpa.html#product-category"><i class="fa fa-check"></i><b>4.3.2</b> Product category</a></li>
<li class="chapter" data-level="4.3.3" data-path="fpa.html"><a href="fpa.html#manufactuer"><i class="fa fa-check"></i><b>4.3.3</b> Manufactuer</a></li>
<li class="chapter" data-level="4.3.4" data-path="fpa.html"><a href="fpa.html#store"><i class="fa fa-check"></i><b>4.3.4</b> Store</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="fpa.html"><a href="fpa.html#info-graphic"><i class="fa fa-check"></i><b>4.4</b> Info graphic</a></li>
<li class="chapter" data-level="4.5" data-path="fpa.html"><a href="fpa.html#report"><i class="fa fa-check"></i><b>4.5</b> Report</a></li>
<li class="chapter" data-level="4.6" data-path="fpa.html"><a href="fpa.html#dashboard"><i class="fa fa-check"></i><b>4.6</b> Dashboard</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="external-auditors.html"><a href="external-auditors.html"><i class="fa fa-check"></i><b>5</b> External Auditors</a>
<ul>
<li class="chapter" data-level="5.1" data-path="external-auditors.html"><a href="external-auditors.html#cleaning"><i class="fa fa-check"></i><b>5.1</b> Cleaning</a></li>
<li class="chapter" data-level="5.2" data-path="external-auditors.html"><a href="external-auditors.html#validation-1"><i class="fa fa-check"></i><b>5.2</b> Validation</a></li>
<li class="chapter" data-level="5.3" data-path="external-auditors.html"><a href="external-auditors.html#eda-1"><i class="fa fa-check"></i><b>5.3</b> EDA</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="external-auditors.html"><a href="external-auditors.html#missing-value"><i class="fa fa-check"></i><b>5.3.1</b> Missing value</a></li>
<li class="chapter" data-level="5.3.2" data-path="external-auditors.html"><a href="external-auditors.html#categorical-1"><i class="fa fa-check"></i><b>5.3.2</b> Categorical</a></li>
<li class="chapter" data-level="5.3.3" data-path="external-auditors.html"><a href="external-auditors.html#numberic"><i class="fa fa-check"></i><b>5.3.3</b> Numberic</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="external-auditors.html"><a href="external-auditors.html#audit-planning"><i class="fa fa-check"></i><b>5.4</b> Audit planning</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="external-auditors.html"><a href="external-auditors.html#test-of-controls"><i class="fa fa-check"></i><b>5.4.1</b> Test of controls</a></li>
<li class="chapter" data-level="5.4.2" data-path="external-auditors.html"><a href="external-auditors.html#digits-tests"><i class="fa fa-check"></i><b>5.4.2</b> Digits tests</a></li>
<li class="chapter" data-level="5.4.3" data-path="external-auditors.html"><a href="external-auditors.html#benfords-law"><i class="fa fa-check"></i><b>5.4.3</b> Benford’s law</a></li>
<li class="chapter" data-level="5.4.4" data-path="external-auditors.html"><a href="external-auditors.html#outlier"><i class="fa fa-check"></i><b>5.4.4</b> Outlier</a></li>
<li class="chapter" data-level="5.4.5" data-path="external-auditors.html"><a href="external-auditors.html#ratios"><i class="fa fa-check"></i><b>5.4.5</b> Ratios</a></li>
<li class="chapter" data-level="5.4.6" data-path="external-auditors.html"><a href="external-auditors.html#cutomers"><i class="fa fa-check"></i><b>5.4.6</b> Cutomers</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="external-auditors.html"><a href="external-auditors.html#substantive-test"><i class="fa fa-check"></i><b>5.5</b> Substantive test</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="external-auditors.html"><a href="external-auditors.html#reconcilation"><i class="fa fa-check"></i><b>5.5.1</b> Reconcilation</a></li>
<li class="chapter" data-level="5.5.2" data-path="external-auditors.html"><a href="external-auditors.html#aging-report"><i class="fa fa-check"></i><b>5.5.2</b> Aging report</a></li>
<li class="chapter" data-level="5.5.3" data-path="external-auditors.html"><a href="external-auditors.html#confirmation-letter"><i class="fa fa-check"></i><b>5.5.3</b> Confirmation letter</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="external-auditors.html"><a href="external-auditors.html#reporting"><i class="fa fa-check"></i><b>5.6</b> Reporting</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="utilities.html"><a href="utilities.html"><i class="fa fa-check"></i><b>6</b> Utilities</a>
<ul>
<li class="chapter" data-level="6.1" data-path="utilities.html"><a href="utilities.html#command-line-tool"><i class="fa fa-check"></i><b>6.1</b> Command line tool</a></li>
<li class="chapter" data-level="6.2" data-path="utilities.html"><a href="utilities.html#pdf-data"><i class="fa fa-check"></i><b>6.2</b> PDF data</a></li>
<li class="chapter" data-level="6.3" data-path="utilities.html"><a href="utilities.html#learnr"><i class="fa fa-check"></i><b>6.3</b> Learnr</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analytics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="external-auditors" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> External Auditors</h1>
<p>This chapter is written from External Auditors perspective. Has said that, techniques can be used by other accounting professionals. External auditors usually perform audit procedures on Trial balance throughout the process from audit planning and substantive testing to reporting. Those audit procedures typically include 1) test of control; 2) identification of outlier; 3) ratios; 4) confirmation letters; 5) vouching. For illustration purpose, the audit scope is revenue and account receivables accounts.</p>
<div id="cleaning" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Cleaning</h2>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="external-auditors.html#cb316-1" aria-hidden="true" tabindex="-1"></a>cells <span class="ot">&lt;-</span> tidyxl<span class="sc">::</span><span class="fu">xlsx_cells</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/gl_stewart.xlsx&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb316-2"><a href="external-auditors.html#cb316-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>is_blank) <span class="sc">%&gt;%</span></span>
<span id="cb316-3"><a href="external-auditors.html#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(row, col, data_type, numeric, date, character)</span>
<span id="cb316-4"><a href="external-auditors.html#cb316-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-5"><a href="external-auditors.html#cb316-5" aria-hidden="true" tabindex="-1"></a>gl <span class="ot">&lt;-</span> cells <span class="sc">%&gt;%</span></span>
<span id="cb316-6"><a href="external-auditors.html#cb316-6" aria-hidden="true" tabindex="-1"></a>  unpivotr<span class="sc">::</span><span class="fu">behead</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;field1&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-7"><a href="external-auditors.html#cb316-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>col) <span class="sc">%&gt;%</span></span>
<span id="cb316-8"><a href="external-auditors.html#cb316-8" aria-hidden="true" tabindex="-1"></a>  unpivotr<span class="sc">::</span><span class="fu">spatter</span>(field1) <span class="sc">%&gt;%</span></span>
<span id="cb316-9"><a href="external-auditors.html#cb316-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>row) <span class="sc">%&gt;%</span></span>
<span id="cb316-10"><a href="external-auditors.html#cb316-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">account =</span> <span class="fu">coalesce</span>(account, bf),</span>
<span id="cb316-11"><a href="external-auditors.html#cb316-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">subaccount =</span> <span class="fu">coalesce</span>(subaccount, account)) <span class="sc">%&gt;%</span></span>
<span id="cb316-12"><a href="external-auditors.html#cb316-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(account, <span class="at">.direction =</span> <span class="st">&quot;down&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-13"><a href="external-auditors.html#cb316-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(subaccount, <span class="at">.direction =</span> <span class="st">&quot;down&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb316-14"><a href="external-auditors.html#cb316-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(account, subaccount, Type, Date, Num, Adj, Name, Memo, Split, Debit, Credit, Balance) <span class="sc">%&gt;%</span></span>
<span id="cb316-15"><a href="external-auditors.html#cb316-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="st">&quot;%Y-%m-%d&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb316-16"><a href="external-auditors.html#cb316-16" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb316-17"><a href="external-auditors.html#cb316-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">replace_na</span>(<span class="fu">list</span>(<span class="at">debit =</span> <span class="dv">0</span>, <span class="at">credit =</span> <span class="dv">0</span>, <span class="at">balance =</span> <span class="dv">0</span>))</span>
<span id="cb316-18"><a href="external-auditors.html#cb316-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb316-19"><a href="external-auditors.html#cb316-19" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(gl, here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/gl.csv&quot;</span>))</span></code></pre></div>
</div>
<div id="validation-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Validation</h2>
<p>Remove unused column of adj. <code>filter</code> out <code>NA</code> out of column of type as they are subtotal. Transaction dates are within the range of audit period (2018-01-01, 2018-12-31). Control totals of debit and credit is same. Data dictionary and Chart of Accounts (COA) are provided.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="external-auditors.html#cb317-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data/gl.csv&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb317-2"><a href="external-auditors.html#cb317-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">-</span>adj) <span class="sc">%&gt;%</span> </span>
<span id="cb317-3"><a href="external-auditors.html#cb317-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(type)) <span class="sc">%&gt;%</span> </span>
<span id="cb317-4"><a href="external-auditors.html#cb317-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> lubridate<span class="sc">::</span><span class="fu">wday</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb317-5"><a href="external-auditors.html#cb317-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>), </span>
<span id="cb317-6"><a href="external-auditors.html#cb317-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">quarter =</span> <span class="fu">factor</span>(lubridate<span class="sc">::</span><span class="fu">quarter</span>(date)))</span></code></pre></div>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="external-auditors.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">range</span>(gl_df<span class="sc">$</span>date, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>&gt; [1] &quot;2018-01-01&quot; &quot;2018-12-31&quot;</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="external-auditors.html#cb320-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> <span class="fu">select</span>(debit, credit) <span class="sc">%&gt;%</span> <span class="fu">colSums</span>()</span></code></pre></div>
<pre><code>&gt;   debit  credit 
&gt; 2136029 2136029</code></pre>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="external-auditors.html#cb322-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tribble</span>(<span class="sc">~</span>Original, <span class="sc">~</span>Description, <span class="sc">~</span>Rename, </span>
<span id="cb322-2"><a href="external-auditors.html#cb322-2" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;&quot;</span>, <span class="st">&quot;Row number&quot;</span> , <span class="st">&quot;id&quot;</span>, </span>
<span id="cb322-3"><a href="external-auditors.html#cb322-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;account&quot;</span>, <span class="st">&quot;Charter of Accounts&quot;</span>, <span class="st">&quot;account&quot;</span>, </span>
<span id="cb322-4"><a href="external-auditors.html#cb322-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;subaccount&quot;</span>, <span class="st">&quot;Charter of Accounts&quot;</span>, <span class="st">&quot;subaccount&quot;</span>, </span>
<span id="cb322-5"><a href="external-auditors.html#cb322-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;type&quot;</span>, <span class="st">&quot;Invoice/Payment&quot;</span>, <span class="st">&quot;type&quot;</span>, </span>
<span id="cb322-6"><a href="external-auditors.html#cb322-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;date&quot;</span>, <span class="st">&quot;JV posting date&quot;</span>, <span class="st">&quot;date&quot;</span>,  </span>
<span id="cb322-7"><a href="external-auditors.html#cb322-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;num&quot;</span>, <span class="st">&quot;JV number&quot;</span>, <span class="st">&quot;num&quot;</span>,</span>
<span id="cb322-8"><a href="external-auditors.html#cb322-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;adj&quot;</span>, <span class="st">&quot;JV adjustment&quot;</span>, <span class="st">&quot;adj&quot;</span>,</span>
<span id="cb322-9"><a href="external-auditors.html#cb322-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;name&quot;</span>, <span class="st">&quot;Customers/Suppliers&quot;</span>, <span class="st">&quot;name&quot;</span>,</span>
<span id="cb322-10"><a href="external-auditors.html#cb322-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;memo&quot;</span>, <span class="st">&quot;JV description&quot;</span>, <span class="st">&quot;memo&quot;</span>,</span>
<span id="cb322-11"><a href="external-auditors.html#cb322-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;split&quot;</span>, <span class="st">&quot;JV double entries&quot;</span>, <span class="st">&quot;split&quot;</span>,</span>
<span id="cb322-12"><a href="external-auditors.html#cb322-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;debit&quot;</span>, <span class="st">&quot;JV amount&quot;</span>, <span class="st">&quot;debit&quot;</span>, </span>
<span id="cb322-13"><a href="external-auditors.html#cb322-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;credit&quot;</span>, <span class="st">&quot;JV amount&quot;</span>, <span class="st">&quot;credit&quot;</span>, </span>
<span id="cb322-14"><a href="external-auditors.html#cb322-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;balance&quot;</span>, <span class="st">&quot;Cumulated JV amount&quot;</span>, <span class="st">&quot;balance&quot;</span>, </span>
<span id="cb322-15"><a href="external-auditors.html#cb322-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;weekday&quot;</span>, <span class="st">&quot;Mutated variable&quot;</span>, <span class="st">&quot;weekday&quot;</span>, </span>
<span id="cb322-16"><a href="external-auditors.html#cb322-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;month&quot;</span>, <span class="st">&quot;Mutated variable&quot;</span>, <span class="st">&quot;month&quot;</span>, </span>
<span id="cb322-17"><a href="external-auditors.html#cb322-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;quarter&quot;</span>, <span class="st">&quot;Mutated variable&quot;</span>, <span class="st">&quot;quarter&quot;</span>) </span>
<span id="cb322-18"><a href="external-auditors.html#cb322-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-19"><a href="external-auditors.html#cb322-19" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> </span>
<span id="cb322-20"><a href="external-auditors.html#cb322-20" aria-hidden="true" tabindex="-1"></a>  DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="at">rownames =</span> <span class="cn">FALSE</span>, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">paging =</span> <span class="cn">TRUE</span>, <span class="at">pageLength =</span> <span class="dv">20</span>))</span></code></pre></div>
<div id="htmlwidget-29c3b8d7c07a6e6fcb50" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-29c3b8d7c07a6e6fcb50">{"x":{"filter":"none","data":[["","account","subaccount","type","date","num","adj","name","memo","split","debit","credit","balance","weekday","month","quarter"],["Row number","Charter of Accounts","Charter of Accounts","Invoice/Payment","JV posting date","JV number","JV adjustment","Customers/Suppliers","JV description","JV double entries","JV amount","JV amount","Cumulated JV amount","Mutated variable","Mutated variable","Mutated variable"],["id","account","subaccount","type","date","num","adj","name","memo","split","debit","credit","balance","weekday","month","quarter"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>Original<\/th>\n      <th>Description<\/th>\n      <th>Rename<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"paging":true,"pageLength":20,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="external-auditors.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(collapsibleTree)</span>
<span id="cb323-2"><a href="external-auditors.html#cb323-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-3"><a href="external-auditors.html#cb323-3" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb323-4"><a href="external-auditors.html#cb323-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapsibleTree</span>(<span class="at">hierarchy =</span> <span class="fu">c</span>(<span class="st">&quot;account&quot;</span>, <span class="st">&quot;subaccount&quot;</span>, <span class="st">&quot;name&quot;</span>),</span>
<span id="cb323-5"><a href="external-auditors.html#cb323-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">width =</span> <span class="dv">800</span>,</span>
<span id="cb323-6"><a href="external-auditors.html#cb323-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">zoomable =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<div id="htmlwidget-36689ac142fdd03473f9" style="width:800px;height:480px;" class="collapsibleTree html-widget"></div>
<script type="application/json" data-for="htmlwidget-36689ac142fdd03473f9">{"x":{"data":{"name":".","children":[{"name":"Company Checking Account","children":[{"name":"Company Checking Account","children":[{"name":"Kuver Property"},{"name":"Online Accounting"},{"name":"Deborah Wood (Owner)"},{"name":"Gas & Electic Company"},{"name":"King, Vicki"},{"name":"Automobile Loan Company"},{"name":"Bolinski, Rafal"},{"name":"Deen, Jeannette"},{"name":"Office Supply Store"},{"name":"Local Phone Company"},{"name":"Cell Phone Company"},{"name":"Fisse Fast Package Delivery"},{"name":"Gretton Insurance Co."},{"name":"Payroll Service Co."},{"name":"Pace Shipping Supplies"},{"name":"Health Insurance Co."},{"name":"Novello Lights Magazine"},{"name":"Credit Card"},{"name":"Jeff's Janitorial"},{"name":"Lawson Professional Seminars, Inc."},{"name":"Professional Association"},{"name":"Automobile Insurance Company"},{"name":"Jonathan Graham (reimbursments)"},{"name":"Local Bank"},{"name":"Sec125 Administrator"},{"name":"Paulsen's Lighting"},{"name":"Legal Firm"},{"name":"Lincoln Office Equip."},{"name":"City of Bayshore"},{"name":"County of Middlefield"},{"name":"Postmaster"},{"name":"Printing Shop"},{"name":"Foster Lighting"},{"name":"Hall Lighting & Accessories"},{"name":"Peacock Bulb Manufacturing Company"},{"name":"Department of Automobiles"},{"name":"Accounting Firm"},{"name":"Electronics Manufacturer"},{"name":"Mullen Travel"},{"name":"Electronics & Computer Store"},{"name":"Winkon Public Relations"},{"name":"Professional Subscriptions"},{"name":"Women's Shelter"},{"name":"Graham, Jonathan"},{"name":"Wood, Deborah"}]}]},{"name":"Payroll Clearing (owner's time)","children":[{"name":"Payroll Clearing (owner's time)","children":[{"name":"Wood, Deborah"}]}]},{"name":"Petty Cash Account","children":[{"name":"Petty Cash Account","children":[{"name":"Deborah Wood (Owner)"}]}]},{"name":"Accounts Receivable","children":[{"name":"Accounts Receivable","children":[{"name":"Baker's Professional Lighting:Store #25"},{"name":"Godwin Lighting Depot:Store #202"},{"name":"Miscellaneous - Retail:Ms. Jann Minor"},{"name":"Miscellaneous - Retail:Brian Stern"},{"name":"Miscellaneous - Retail:Alison Johnson"},{"name":"Cole Home Builders:Phase 2 - Lot 5"},{"name":"Kern Lighting Warehouse:Store #34"},{"name":"Godwin Lighting Depot:Store #303"},{"name":"Thompson Lighting Stores:Store #15"},{"name":"Cole Home Builders:Phase 1 - Lot 2"},{"name":"Baker's Professional Lighting:Store #05"},{"name":"Stern Commercial Contractor's:Walker Properties"},{"name":"Miscellaneous - Retail:Ruth Kuver"},{"name":"Miscellaneous - Retail:Mrs. Chris Holly"},{"name":"Miscellaneous - Retail:David Lo"},{"name":"Baker's Professional Lighting:Store #15"},{"name":"Lavery Lighting & Design:Store #JL-08"},{"name":"Kern Lighting Warehouse:Store #13"},{"name":"Baker's Professional Lighting:Store #20"},{"name":"Lavery Lighting & Design:Store #JL-06"},{"name":"Miscellaneous - Retail:Mr. Fred Kaseman"},{"name":"Godwin Lighting Depot:Store #404"},{"name":"Dan A. North Builders:McCarthy Properties"},{"name":"Kern Lighting Warehouse:Store #45"},{"name":"Miscellaneous - Retail:Mr. Jay Jessen"},{"name":"Cole Home Builders:Phase 1 - Lot 5"},{"name":"Miscellaneous - Retail:Mrs. Anne Hemp"},{"name":"Godwin Lighting Depot:Store #909"},{"name":"Dan A. North Builders:Wagner Suites"},{"name":"Baker's Professional Lighting:Store #10"},{"name":"Miscellaneous - Retail:Carlos Nazar"},{"name":"Thompson Lighting Stores:Store #20"},{"name":"Cole Home Builders:Phase 1 - Lot 4"},{"name":"Godwin Lighting Depot:Store #1020"},{"name":"Miscellaneous - Retail:Anne Loomis"},{"name":"Thompson Lighting Stores:Store #30"},{"name":"Thompson Lighting Stores:Store #50"},{"name":"Kern Lighting Warehouse:Store #01"},{"name":"Thompson Lighting Stores:Store #40"},{"name":"Miscellaneous - Retail:Sean Martin"},{"name":"Miscellaneous - Retail:Jann Minor"},{"name":"Dan A. North Builders:Turner Suites"},{"name":"Miscellaneous - Retail:Jason Helper"},{"name":"Miscellaneous - Retail:John Huhn"},{"name":"Stern Commercial Contractor's:Tittle Properties"},{"name":"Miscellaneous - Retail:Doug Jacobsen"},{"name":"Miscellaneous - Retail:Peter Karpas"},{"name":"Stern Commercial Contractor's:Wilson Suites"},{"name":"Miscellaneous - Retail:Valesha Jones"},{"name":"Lavery Lighting & Design:Store #JL-01"},{"name":"Lavery Lighting & Design:Store #JL-04"},{"name":"Miscellaneous - Retail:Melanie Hall"},{"name":"Miscellaneous - Retail:Lara Gussman"},{"name":"Dan A. North Builders:Custom Order - Suite 100A"}]}]},{"name":"Inventory Asset","children":[{"name":"Inventory Asset","children":[{"name":"Peacock Bulb Manufacturing Company"},{"name":"Paulsen's Lighting"},{"name":"Baker's Professional Lighting:Store #25"},{"name":"Godwin Lighting Depot:Store #202"},{"name":"Miscellaneous - Retail:Ms. Jann Minor"},{"name":"Miscellaneous - Retail:Brian Stern"},{"name":"Miscellaneous - Retail:Alison Johnson"},{"name":"Cole Home Builders:Phase 2 - Lot 5"},{"name":"Kern Lighting Warehouse:Store #34"},{"name":"Hall Lighting & Accessories"},{"name":"Foster Lighting"},{"name":"Godwin Lighting Depot:Store #303"},{"name":"Thompson Lighting Stores:Store #15"},{"name":"Cole Home Builders:Phase 1 - Lot 2"},{"name":"Baker's Professional Lighting:Store #05"},{"name":"Miscellaneous - Retail:Ruth Kuver"},{"name":"Miscellaneous - Retail:Mrs. Chris Holly"},{"name":"Miscellaneous - Retail:David Lo"},{"name":"Baker's Professional Lighting:Store #15"},{"name":"Baker's Professional Lighting:Store #20"},{"name":"Lavery Lighting & Design:Store #JL-06"},{"name":"Miscellaneous - Retail:Mr. Fred Kaseman"},{"name":"Godwin Lighting Depot:Store #404"},{"name":"Dan A. North Builders:McCarthy Properties"},{"name":"Kern Lighting Warehouse:Store #45"},{"name":"Miscellaneous - Retail:Mr. Jay Jessen"},{"name":"Kern Lighting Warehouse:Store #13"},{"name":"Cole Home Builders:Phase 1 - Lot 5"},{"name":"Miscellaneous - Retail:Mrs. Anne Hemp"},{"name":"Godwin Lighting Depot:Store #909"},{"name":"Dan A. North Builders:Wagner Suites"},{"name":"Baker's Professional Lighting:Store #10"},{"name":"Miscellaneous - Retail:Carlos Nazar"},{"name":"Thompson Lighting Stores:Store #20"},{"name":"Cole Home Builders:Phase 1 - Lot 4"},{"name":"Godwin Lighting Depot:Store #1020"},{"name":"Miscellaneous - Retail:Anne Loomis"},{"name":"Thompson Lighting Stores:Store #30"},{"name":"Thompson Lighting Stores:Store #50"},{"name":"Kern Lighting Warehouse:Store #01"},{"name":"Thompson Lighting Stores:Store #40"},{"name":"Miscellaneous - Retail:Sean Martin"},{"name":"Miscellaneous - Retail:Jann Minor"},{"name":"Dan A. North Builders:Turner Suites"},{"name":"Miscellaneous - Retail:Jason Helper"},{"name":"Miscellaneous - Retail:John Huhn"},{"name":"Stern Commercial Contractor's:Tittle Properties"},{"name":"Miscellaneous - Retail:Doug Jacobsen"},{"name":"Miscellaneous - Retail:Peter Karpas"},{"name":"Stern Commercial Contractor's:Wilson Suites"},{"name":"Miscellaneous - Retail:Valesha Jones"},{"name":"Lavery Lighting & Design:Store #JL-01"},{"name":"Lavery Lighting & Design:Store #JL-04"},{"name":"Miscellaneous - Retail:Melanie Hall"},{"name":"Lavery Lighting & Design:Store #JL-08"},{"name":"Miscellaneous - Retail:Lara Gussman"},{"name":"Stern Commercial Contractor's:Walker Properties"}]}]},{"name":"Prepaids","children":[{"name":"Prepaid Insurance","children":[{"name":"Gretton Insurance Co."}]}]},{"name":"Undeposited Funds","children":[{"name":"Undeposited Funds","children":[{"name":"Lavery Lighting & Design:Store #JL-01"},{"name":"Stern Commercial Contractor's:Wilson Suites"},{"name":"Lavery Lighting & Design:Store #JL-04"},{"name":"Miscellaneous - Retail:Ms. Jann Minor"},{"name":"Miscellaneous - Retail:Brian Stern"},{"name":"Miscellaneous - Retail:Alison Johnson"},{"name":"Baker's Professional Lighting:Store #25"},{"name":"Stern Commercial Contractor's:Walker Properties"},{"name":"Miscellaneous - Retail:Ruth Kuver"},{"name":"Miscellaneous - Retail:Mrs. Chris Holly"},{"name":"Miscellaneous - Retail:David Lo"},{"name":"Godwin Lighting Depot:Store #202"},{"name":"Godwin Lighting Depot:Store #303"},{"name":"Kern Lighting Warehouse:Store #34"},{"name":"Kern Lighting Warehouse:Store #13"},{"name":"Miscellaneous - Retail:Mr. Fred Kaseman"},{"name":"Baker's Professional Lighting:Store #05"},{"name":"Cole Home Builders:Phase 2 - Lot 5"},{"name":"Baker's Professional Lighting:Store #15"},{"name":"Lavery Lighting & Design:Store #JL-08"},{"name":"Kern Lighting Warehouse:Store #01"},{"name":"Miscellaneous - Retail:Mr. Jay Jessen"},{"name":"Baker's Professional Lighting:Store #20"},{"name":"Cole Home Builders:Phase 1 - Lot 2"},{"name":"Thompson Lighting Stores:Store #15"},{"name":"Miscellaneous - Retail:Mrs. Anne Hemp"},{"name":"Godwin Lighting Depot:Store #404"},{"name":"Lavery Lighting & Design:Store #JL-06"},{"name":"Dan A. North Builders:McCarthy Properties"},{"name":"Kern Lighting Warehouse:Store #45"},{"name":"Miscellaneous - Retail:Carlos Nazar"},{"name":"Dan A. North Builders:Wagner Suites"},{"name":"Godwin Lighting Depot:Store #909"},{"name":"Miscellaneous - Retail:Anne Loomis"},{"name":"Baker's Professional Lighting:Store #10"},{"name":"Cole Home Builders:Phase 1 - Lot 5"},{"name":"Godwin Lighting Depot:Store #1020"},{"name":"Cole Home Builders:Phase 1 - Lot 4"},{"name":"Miscellaneous - Retail:Sean Martin"},{"name":"Thompson Lighting Stores:Store #20"},{"name":"Miscellaneous - Retail:Jann Minor"},{"name":"Thompson Lighting Stores:Store #50"},{"name":"Miscellaneous - Retail:Jason Helper"},{"name":"Miscellaneous - Retail:John Huhn"},{"name":"Thompson Lighting Stores:Store #30"},{"name":"Thompson Lighting Stores:Store #40"},{"name":"Dan A. North Builders:Turner Suites"},{"name":"Miscellaneous - Retail:Doug Jacobsen"},{"name":"Miscellaneous - Retail:Peter Karpas"},{"name":"Miscellaneous - Retail:Valesha Jones"},{"name":"Miscellaneous - Retail:Melanie Hall"},{"name":"Stern Commercial Contractor's:Tittle Properties"},{"name":"Miscellaneous - Retail:Lara Gussman"}]}]},{"name":"Computer & Office Equipment","children":[{"name":"Computer & Office Equipment","children":[{"name":"Electronics Manufacturer"}]}]},{"name":"Accumulated Depreciation","children":[{"name":"Accumulated Depreciation"}]},{"name":"Accounts Payable","children":[{"name":"Accounts Payable","children":[{"name":"Peacock Bulb Manufacturing Company"},{"name":"Paulsen's Lighting"},{"name":"Hall Lighting & Accessories"},{"name":"Foster Lighting"},{"name":"Fisse Fast Package Delivery"},{"name":"Printing Shop"},{"name":"Michael Kretchmar"}]}]},{"name":"QuickBooks Credit Card","children":[{"name":"QuickBooks Credit Card","children":[{"name":"Randy's Floral"},{"name":"Larsen Gas Station"},{"name":"Business Supply Center"},{"name":"Credit Card"},{"name":"Jenny's Cafe"},{"name":"Vin's Restaurant"},{"name":"Norton Discount Warehouse"},{"name":"Local Restaurant"},{"name":"Electronics & Computer Store"},{"name":"Online Accounting"},{"name":"Local Market"},{"name":"Ken Chen Coffee"},{"name":"Office Supply Store"},{"name":"Cecil's Lockworks"}]}]},{"name":"Customer Deposits","children":[{"name":"Customer Deposits","children":[{"name":"Dan A. North Builders:Custom Order - Suite 100A"}]}]},{"name":"Line of Credit","children":[{"name":"Line of Credit"}]},{"name":"Payroll Liabilities","children":[{"name":"Payroll Taxes Payable","children":[{"name":"Bolinski, Rafal"},{"name":"Deen, Jeannette"},{"name":"King, Vicki"},{"name":"Wood, Deborah"},{"name":"Local Bank"},{"name":"Graham, Jonathan"}]},{"name":"SEC125 Payable","children":[{"name":"King, Vicki"},{"name":"Sec125 Administrator"},{"name":"Graham, Jonathan"},{"name":"Bolinski, Rafal"},{"name":"Deen, Jeannette"}]}]},{"name":"Deborah Wood Equity","children":[{"name":"Deborah Wood's Time to Jobs","children":[{"name":"Wood, Deborah"}]},{"name":"Deborah Wood Draws","children":[{"name":"Deborah Wood (Owner)"}]}]},{"name":"Opening Bal Equity","children":[{"name":"Opening Bal Equity"}]},{"name":"Revenue","children":[{"name":"Revenue","children":[{"name":"Baker's Professional Lighting:Store #25"},{"name":"Godwin Lighting Depot:Store #202"},{"name":"Miscellaneous - Retail:Ms. Jann Minor"},{"name":"Miscellaneous - Retail:Brian Stern"},{"name":"Miscellaneous - Retail:Alison Johnson"},{"name":"Cole Home Builders:Phase 2 - Lot 5"},{"name":"Kern Lighting Warehouse:Store #34"},{"name":"Godwin Lighting Depot:Store #303"},{"name":"Thompson Lighting Stores:Store #15"},{"name":"Cole Home Builders:Phase 1 - Lot 2"},{"name":"Baker's Professional Lighting:Store #05"},{"name":"Miscellaneous - Retail:Ruth Kuver"},{"name":"Miscellaneous - Retail:Mrs. Chris Holly"},{"name":"Miscellaneous - Retail:David Lo"},{"name":"Baker's Professional Lighting:Store #15"},{"name":"Lavery Lighting & Design:Store #JL-08"},{"name":"Baker's Professional Lighting:Store #20"},{"name":"Lavery Lighting & Design:Store #JL-06"},{"name":"Miscellaneous - Retail:Mr. Fred Kaseman"},{"name":"Godwin Lighting Depot:Store #404"},{"name":"Dan A. North Builders:McCarthy Properties"},{"name":"Kern Lighting Warehouse:Store #45"},{"name":"Miscellaneous - Retail:Mr. Jay Jessen"},{"name":"Kern Lighting Warehouse:Store #13"},{"name":"Cole Home Builders:Phase 1 - Lot 5"},{"name":"Miscellaneous - Retail:Mrs. Anne Hemp"},{"name":"Godwin Lighting Depot:Store #909"},{"name":"Dan A. North Builders:Wagner Suites"},{"name":"Baker's Professional Lighting:Store #10"},{"name":"Miscellaneous - Retail:Carlos Nazar"},{"name":"Thompson Lighting Stores:Store #20"},{"name":"Cole Home Builders:Phase 1 - Lot 4"},{"name":"Godwin Lighting Depot:Store #1020"},{"name":"Miscellaneous - Retail:Anne Loomis"},{"name":"Thompson Lighting Stores:Store #30"},{"name":"Thompson Lighting Stores:Store #50"},{"name":"Kern Lighting Warehouse:Store #01"},{"name":"Thompson Lighting Stores:Store #40"},{"name":"Miscellaneous - Retail:Sean Martin"},{"name":"Miscellaneous - Retail:Jann Minor"},{"name":"Dan A. North Builders:Turner Suites"},{"name":"Miscellaneous - Retail:Jason Helper"},{"name":"Miscellaneous - Retail:John Huhn"},{"name":"Stern Commercial Contractor's:Tittle Properties"},{"name":"Miscellaneous - Retail:Doug Jacobsen"},{"name":"Miscellaneous - Retail:Peter Karpas"},{"name":"Stern Commercial Contractor's:Wilson Suites"},{"name":"Miscellaneous - Retail:Valesha Jones"},{"name":"Lavery Lighting & Design:Store #JL-01"},{"name":"Lavery Lighting & Design:Store #JL-04"},{"name":"Miscellaneous - Retail:Melanie Hall"},{"name":"Miscellaneous - Retail:Lara Gussman"},{"name":"Stern Commercial Contractor's:Walker Properties"},{"name":"Dan A. North Builders:Custom Order - Suite 100A"}]}]},{"name":"Direct Labor","children":[{"name":"Wages - Sales-Inside","children":[{"name":"Graham, Jonathan"}]},{"name":"Wages - Warehouse","children":[{"name":"Bolinski, Rafal"},{"name":"Deen, Jeannette"}]}]},{"name":"Freight Costs","children":[{"name":"Freight Costs","children":[{"name":"Fisse Fast Package Delivery"}]}]},{"name":"Packaging Materials","children":[{"name":"Packaging Materials","children":[{"name":"Printing Shop"}]}]},{"name":"Purchases  (Cost of Goods)","children":[{"name":"Purchases  (Cost of Goods)","children":[{"name":"Baker's Professional Lighting:Store #25"},{"name":"Paulsen's Lighting"},{"name":"Godwin Lighting Depot:Store #202"},{"name":"Miscellaneous - Retail:Ms. Jann Minor"},{"name":"Miscellaneous - Retail:Brian Stern"},{"name":"Miscellaneous - Retail:Alison Johnson"},{"name":"Cole Home Builders:Phase 2 - Lot 5"},{"name":"Kern Lighting Warehouse:Store #34"},{"name":"Hall Lighting & Accessories"},{"name":"Godwin Lighting Depot:Store #303"},{"name":"Printing Shop"},{"name":"Thompson Lighting Stores:Store #15"},{"name":"Cole Home Builders:Phase 1 - Lot 2"},{"name":"Baker's Professional Lighting:Store #05"},{"name":"Miscellaneous - Retail:Ruth Kuver"},{"name":"Miscellaneous - Retail:Mrs. Chris Holly"},{"name":"Miscellaneous - Retail:David Lo"},{"name":"Baker's Professional Lighting:Store #15"},{"name":"Baker's Professional Lighting:Store #20"},{"name":"Lavery Lighting & Design:Store #JL-06"},{"name":"Miscellaneous - Retail:Mr. Fred Kaseman"},{"name":"Godwin Lighting Depot:Store #404"},{"name":"Dan A. North Builders:McCarthy Properties"},{"name":"Kern Lighting Warehouse:Store #45"},{"name":"Miscellaneous - Retail:Mr. Jay Jessen"},{"name":"Kern Lighting Warehouse:Store #13"},{"name":"Cole Home Builders:Phase 1 - Lot 5"},{"name":"Miscellaneous - Retail:Mrs. Anne Hemp"},{"name":"Godwin Lighting Depot:Store #909"},{"name":"Dan A. North Builders:Wagner Suites"},{"name":"Baker's Professional Lighting:Store #10"},{"name":"Miscellaneous - Retail:Carlos Nazar"},{"name":"Thompson Lighting Stores:Store #20"},{"name":"Cole Home Builders:Phase 1 - Lot 4"},{"name":"Godwin Lighting Depot:Store #1020"},{"name":"Miscellaneous - Retail:Anne Loomis"},{"name":"Thompson Lighting Stores:Store #30"},{"name":"Thompson Lighting Stores:Store #50"},{"name":"Kern Lighting Warehouse:Store #01"},{"name":"Thompson Lighting Stores:Store #40"},{"name":"Miscellaneous - Retail:Sean Martin"},{"name":"Foster Lighting"},{"name":"Miscellaneous - Retail:Jann Minor"},{"name":"Dan A. North Builders:Turner Suites"},{"name":"Miscellaneous - Retail:Jason Helper"},{"name":"Miscellaneous - Retail:John Huhn"},{"name":"Stern Commercial Contractor's:Tittle Properties"},{"name":"Miscellaneous - Retail:Doug Jacobsen"},{"name":"Miscellaneous - Retail:Peter Karpas"},{"name":"Stern Commercial Contractor's:Wilson Suites"},{"name":"Miscellaneous - Retail:Valesha Jones"},{"name":"Lavery Lighting & Design:Store #JL-01"},{"name":"Lavery Lighting & Design:Store #JL-04"},{"name":"Miscellaneous - Retail:Melanie Hall"},{"name":"Lavery Lighting & Design:Store #JL-08"},{"name":"Miscellaneous - Retail:Lara Gussman"},{"name":"Stern Commercial Contractor's:Walker Properties"},{"name":"Dan A. North Builders:Custom Order - Suite 100A"}]}]},{"name":"Sales Commission (outside reps)","children":[{"name":"Sales Commission (outside reps)","children":[{"name":"Michael Kretchmar"}]}]},{"name":"Advertising Expense","children":[{"name":"Advertising Expense","children":[{"name":"Novello Lights Magazine"}]}]},{"name":"Business License & Fees","children":[{"name":"Business License & Fees","children":[{"name":"City of Bayshore"},{"name":"County of Middlefield"}]}]},{"name":"Car/Truck Expense","children":[{"name":"Car Lease","children":[{"name":"Automobile Loan Company"}]},{"name":"Gas","children":[{"name":"Larsen Gas Station"},{"name":"Jonathan Graham (reimbursments)"},{"name":"Deborah Wood (Owner)"},{"name":"King, Vicki"}]},{"name":"Insurance-Auto","children":[{"name":"Automobile Insurance Company"}]},{"name":"Mileage","children":[{"name":"Graham, Jonathan"}]},{"name":"Registration & License","children":[{"name":"Department of Automobiles"}]},{"name":"Repairs & Maintenance","children":[{"name":"Deborah Wood (Owner)"}]}]},{"name":"Conferences and Seminars","children":[{"name":"Conferences and Seminars","children":[{"name":"Lawson Professional Seminars, Inc."},{"name":"Professional Association"}]}]},{"name":"Contributions","children":[{"name":"Contributions","children":[{"name":"Women's Shelter"}]}]},{"name":"Depreciation Expense","children":[{"name":"Depreciation Expense"}]},{"name":"Dues and Subscriptions","children":[{"name":"Dues and Subscriptions","children":[{"name":"Professional Association"},{"name":"Professional Subscriptions"}]}]},{"name":"Insurance","children":[{"name":"General Liability Insurance","children":[{"name":"Gretton Insurance Co."}]},{"name":"Owner's Health Insurance","children":[{"name":"Health Insurance Co."}]},{"name":"Professional Liability Insuranc"},{"name":"Worker's Compensation","children":[{"name":"Gretton Insurance Co."}]}]},{"name":"Maintenance/Janitorial","children":[{"name":"Maintenance/Janitorial","children":[{"name":"Jeff's Janitorial"}]}]},{"name":"Marketing Expense","children":[{"name":"Marketing Expense","children":[{"name":"Printing Shop"},{"name":"Winkon Public Relations"}]}]},{"name":"Meals and Entertainment","children":[{"name":"Meals and Entertainment","children":[{"name":"King, Vicki"},{"name":"Jonathan Graham (reimbursments)"},{"name":"Jenny's Cafe"},{"name":"Vin's Restaurant"},{"name":"Deborah Wood (Owner)"},{"name":"Local Restaurant"}]}]},{"name":"Office Equipment","children":[{"name":"Office Equipment","children":[{"name":"Pace Shipping Supplies"},{"name":"Lincoln Office Equip."}]}]},{"name":"Postage and Delivery","children":[{"name":"Postage and Delivery","children":[{"name":"Fisse Fast Package Delivery"},{"name":"Postmaster"}]}]},{"name":"Professional Fees","children":[{"name":"Accounting Fees","children":[{"name":"Online Accounting"},{"name":"Accounting Firm"}]},{"name":"Legal Fees","children":[{"name":"Legal Firm"}]},{"name":"Payroll Service Fees","children":[{"name":"Payroll Service Co."}]}]},{"name":"Promotional Expense","children":[{"name":"Promotional Expense","children":[{"name":"Randy's Floral"},{"name":"Printing Shop"}]}]},{"name":"Rent","children":[{"name":"Rent","children":[{"name":"Kuver Property"}]}]},{"name":"Repairs","children":[{"name":"Computer Repairs","children":[{"name":"Electronics & Computer Store"}]}]},{"name":"Supplies","children":[{"name":"Supplies","children":[{"name":"Office Supply Store"},{"name":"Business Supply Center"},{"name":"Deborah Wood (Owner)"},{"name":"Norton Discount Warehouse"},{"name":"Electronics & Computer Store"},{"name":"King, Vicki"},{"name":"Local Market"},{"name":"Printing Shop"},{"name":"Randy's Floral"},{"name":"Ken Chen Coffee"},{"name":"Cecil's Lockworks"}]}]},{"name":"Telephone","children":[{"name":"Telephone","children":[{"name":"Local Phone Company"},{"name":"Cell Phone Company"},{"name":"Jonathan Graham (reimbursments)"},{"name":"Deborah Wood (Owner)"}]}]},{"name":"Travel","children":[{"name":"Travel","children":[{"name":"Deborah Wood (Owner)"},{"name":"Jonathan Graham (reimbursments)"},{"name":"Mullen Travel"},{"name":"King, Vicki"}]}]},{"name":"Utilities","children":[{"name":"Utilities","children":[{"name":"Gas & Electic Company"}]}]},{"name":"Wages","children":[{"name":"Employee Benefits","children":[{"name":"Health Insurance Co."}]},{"name":"Employee Bonus","children":[{"name":"Graham, Jonathan"}]},{"name":"Payroll Tax Expenses","children":[{"name":"Bolinski, Rafal"},{"name":"Deen, Jeannette"},{"name":"King, Vicki"},{"name":"Graham, Jonathan"}]},{"name":"Sick/Holiday & Vacation Pay","children":[{"name":"Wood, Deborah"}]},{"name":"Wages - Office Staff","children":[{"name":"King, Vicki"}]}]},{"name":"Other Expense","children":[{"name":"Interest Expense","children":[{"name":"Local Bank"}]}]}]},"options":{"hierarchy":["account","subaccount","name"],"input":null,"attribute":"leafCount","linkLength":null,"fontSize":10,"tooltip":false,"collapsed":true,"zoomable":true,"margin":{"top":20,"bottom":20,"left":30,"right":260},"fill":"lightsteelblue"}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="eda-1" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> EDA</h2>
<p>Columns of split and balance are left untouched. EDA of numeric is based on revenue data.</p>
<div id="missing-value" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Missing value</h3>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="external-auditors.html#cb324-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb324-2"><a href="external-auditors.html#cb324-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span>formattable<span class="sc">::</span><span class="fu">percent</span>(<span class="fu">mean</span>(<span class="fu">is.na</span>(.))))) <span class="sc">%&gt;%</span> </span>
<span id="cb324-3"><a href="external-auditors.html#cb324-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>()</span></code></pre></div>
<pre><code>&gt; # A tibble: 14 x 2
&gt;    key        value     
&gt;    &lt;chr&gt;      &lt;formttbl&gt;
&gt;  1 account    0.00%     
&gt;  2 subaccount 0.00%     
&gt;  3 type       0.00%     
&gt;  4 date       0.00%     
&gt;  5 num        6.81%     
&gt;  6 name       2.16%     
&gt;  7 memo       27.78%    
&gt;  8 split      0.00%     
&gt;  9 debit      0.00%     
&gt; 10 credit     0.00%     
&gt; 11 balance    0.00%     
&gt; 12 weekday    0.00%     
&gt; 13 month      0.00%     
&gt; 14 quarter    0.00%</code></pre>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="external-auditors.html#cb326-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> visdat<span class="sc">::</span><span class="fu">vis_miss</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="external-auditors.html#cb327-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> visdat<span class="sc">::</span><span class="fu">vis_dat</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-142-2.png" width="672" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="external-auditors.html#cb328-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> naniar<span class="sc">::</span><span class="fu">gg_miss_upset</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-142-3.png" width="672" /></p>
</div>
<div id="categorical-1" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Categorical</h3>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="external-auditors.html#cb329-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb329-2"><a href="external-auditors.html#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">where</span>(is.character)) <span class="sc">%&gt;%</span> </span>
<span id="cb329-3"><a href="external-auditors.html#cb329-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map_dbl</span>(<span class="sc">~</span><span class="fu">length</span>(<span class="fu">unique</span>(.x)))</span></code></pre></div>
<pre><code>&gt;    account subaccount       type        num       name       memo      split 
&gt;         45         62         12        615        111        411         49</code></pre>
<p>See to which accounts and subaccounts most of transactions in GL are posted.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="external-auditors.html#cb331-1" aria-hidden="true" tabindex="-1"></a>actree <span class="ot">&lt;-</span> gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb331-2"><a href="external-auditors.html#cb331-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(account, subaccount) <span class="sc">%&gt;%</span> </span>
<span id="cb331-3"><a href="external-auditors.html#cb331-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)                                   </span>
<span id="cb331-4"><a href="external-auditors.html#cb331-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-5"><a href="external-auditors.html#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(<span class="at">filename =</span> <span class="st">&quot;img/actree.png&quot;</span>, <span class="at">width =</span> <span class="dv">1600</span>, <span class="at">height =</span> <span class="dv">800</span>)</span>
<span id="cb331-6"><a href="external-auditors.html#cb331-6" aria-hidden="true" tabindex="-1"></a>treemap<span class="sc">::</span><span class="fu">treemap</span>(actree,</span>
<span id="cb331-7"><a href="external-auditors.html#cb331-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">index =</span> <span class="fu">c</span>(<span class="st">&quot;account&quot;</span>, <span class="st">&quot;subaccount&quot;</span>),</span>
<span id="cb331-8"><a href="external-auditors.html#cb331-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vSize =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb331-9"><a href="external-auditors.html#cb331-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">vColor =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb331-10"><a href="external-auditors.html#cb331-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&quot;index&quot;</span>, </span>
<span id="cb331-11"><a href="external-auditors.html#cb331-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">align.labels =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;center&quot;</span>), <span class="fu">c</span>(<span class="st">&quot;right&quot;</span>, <span class="st">&quot;bottom&quot;</span>)), </span>
<span id="cb331-12"><a href="external-auditors.html#cb331-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fontface.labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb331-13"><a href="external-auditors.html#cb331-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fontsize.labels =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">8</span>),</span>
<span id="cb331-14"><a href="external-auditors.html#cb331-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fontcolor.labels =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb331-15"><a href="external-auditors.html#cb331-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">title =</span> <span class="st">&quot;Charter of Accounts&quot;</span>,                      </span>
<span id="cb331-16"><a href="external-auditors.html#cb331-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">fontsize.title =</span> <span class="dv">12</span>,  </span>
<span id="cb331-17"><a href="external-auditors.html#cb331-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">overlap.labels =</span> <span class="fl">0.5</span>,</span>
<span id="cb331-18"><a href="external-auditors.html#cb331-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">inflate.labels =</span> <span class="cn">FALSE</span>,</span>
<span id="cb331-19"><a href="external-auditors.html#cb331-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">palette =</span> <span class="st">&quot;Set3&quot;</span>,  </span>
<span id="cb331-20"><a href="external-auditors.html#cb331-20" aria-hidden="true" tabindex="-1"></a>                 <span class="at">border.col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;white&quot;</span>),</span>
<span id="cb331-21"><a href="external-auditors.html#cb331-21" aria-hidden="true" tabindex="-1"></a>                 <span class="at">border.lwds =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)) </span>
<span id="cb331-22"><a href="external-auditors.html#cb331-22" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="external-auditors.html#cb332-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/actree.png&quot;</span>)</span></code></pre></div>
<p><img src="img/actree.png" width="800" /></p>
<p>Prepare Trial balance and monthly financial statements out of GL, and then export them to Excel as audit working paper.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="external-auditors.html#cb333-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb333-2"><a href="external-auditors.html#cb333-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subaccount) <span class="sc">%&gt;%</span> </span>
<span id="cb333-3"><a href="external-auditors.html#cb333-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(debit, credit), sum)   </span>
<span id="cb333-4"><a href="external-auditors.html#cb333-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-5"><a href="external-auditors.html#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tb)</span></code></pre></div>
<pre><code>&gt; # A tibble: 6 x 3
&gt;   subaccount                 debit  credit
&gt;   &lt;chr&gt;                      &lt;dbl&gt;   &lt;dbl&gt;
&gt; 1 Accounting Fees            2544       0 
&gt; 2 Accounts Payable         131032. 147729.
&gt; 3 Accounts Receivable      408310. 375976.
&gt; 4 Accumulated Depreciation      0     923.
&gt; 5 Advertising Expense        2000       0 
&gt; 6 Business License &amp; Fees     710.      0</code></pre>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="external-auditors.html#cb335-1" aria-hidden="true" tabindex="-1"></a>mth_fs <span class="ot">&lt;-</span> gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb335-2"><a href="external-auditors.html#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(account, subaccount, month) <span class="sc">%&gt;%</span></span>
<span id="cb335-3"><a href="external-auditors.html#cb335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span>                                                        </span>
<span id="cb335-4"><a href="external-auditors.html#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">n</span>()) <span class="sc">%&gt;%</span>                                                           </span>
<span id="cb335-5"><a href="external-auditors.html#cb335-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb335-6"><a href="external-auditors.html#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(account, subaccount, month, balance) <span class="sc">%&gt;%</span> </span>
<span id="cb335-7"><a href="external-auditors.html#cb335-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> month, </span>
<span id="cb335-8"><a href="external-auditors.html#cb335-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> balance, <span class="at">values_fill =</span> <span class="dv">0</span>)  </span>
<span id="cb335-9"><a href="external-auditors.html#cb335-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-10"><a href="external-auditors.html#cb335-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mth_fs)</span></code></pre></div>
<pre><code>&gt; # A tibble: 6 x 14
&gt;   account subaccount     Jan     Feb     Mar     Apr    May    Jun    Jul    Aug
&gt;   &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 Accoun~ Accounts ~ -3.59e4 -45421  -21732. -23299  -3916. -6852. -4067. -4392.
&gt; 2 Accoun~ Accounts ~  2.24e4  10455.  16399.  16583. 21162. 26078. 38024. 43078.
&gt; 3 Accumu~ Accumulat~ -7.69e1   -154.   -231.   -308.  -385.  -462.  -538.  -615.
&gt; 4 Advert~ Advertisi~  5   e2      0       0    1000      0      0   1500      0 
&gt; 5 Busine~ Business ~  0         710.      0       0      0      0      0      0 
&gt; 6 Car/Tr~ Car Lease   5.63e2   1126    1689    2252   2815   3378   3941   4504 
&gt; # ... with 4 more variables: Sep &lt;dbl&gt;, Oct &lt;dbl&gt;, Nov &lt;dbl&gt;, Dec &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="external-auditors.html#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb337-2"><a href="external-auditors.html#cb337-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-3"><a href="external-auditors.html#cb337-3" aria-hidden="true" tabindex="-1"></a>ls_df <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;TB&quot;</span> <span class="ot">=</span> tb, <span class="st">&quot;Budget&quot;</span> <span class="ot">=</span> mth_fs)</span>
<span id="cb337-4"><a href="external-auditors.html#cb337-4" aria-hidden="true" tabindex="-1"></a><span class="fu">write.xlsx</span>(ls_df, <span class="at">file =</span> <span class="st">&quot;supplements/accountant.xlsx&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb338-1"><a href="external-auditors.html#cb338-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/excel_tb1.png&quot;</span>)</span></code></pre></div>
<p><img src="img/excel_tb1.png" width="960" /></p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="external-auditors.html#cb339-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/excel_tb2.png&quot;</span>)</span></code></pre></div>
<p><img src="img/excel_tb2.png" width="960" /></p>
<p><code>count</code> columns of type and month. <code>summarize</code> debit and credit for each type.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="external-auditors.html#cb340-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> <span class="fu">count</span>(type, <span class="at">sort =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>&gt; # A tibble: 12 x 2
&gt;    type                   n
&gt;    &lt;chr&gt;              &lt;int&gt;
&gt;  1 Invoice             2632
&gt;  2 Paycheck            1246
&gt;  3 Check                559
&gt;  4 Payment              176
&gt;  5 Bill                 166
&gt;  6 Deposit              111
&gt;  7 Liability Check      111
&gt;  8 Bill Pmt -Check       84
&gt;  9 General Journal       72
&gt; 10 Credit Card Charge    68
&gt; 11 Transfer              14
&gt; 12 Inventory Adjust       2</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="external-auditors.html#cb342-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb342-2"><a href="external-auditors.html#cb342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(type, account, subaccount, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb342-3"><a href="external-auditors.html#cb342-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, (<span class="fu">n</span>()<span class="sc">-</span><span class="dv">3</span>)<span class="sc">:</span><span class="fu">n</span>())</span></code></pre></div>
<pre><code>&gt; # A tibble: 7 x 4
&gt;   type     account                    subaccount                      n
&gt;   &lt;chr&gt;    &lt;chr&gt;                      &lt;chr&gt;                       &lt;int&gt;
&gt; 1 Invoice  Revenue                    Revenue                       847
&gt; 2 Invoice  Inventory Asset            Inventory Asset               845
&gt; 3 Invoice  Purchases  (Cost of Goods) Purchases  (Cost of Goods)    845
&gt; 4 Paycheck Car/Truck Expense          Mileage                         1
&gt; 5 Paycheck Direct Labor               Wages - Sales-Inside            1
&gt; 6 Paycheck Wages                      Employee Bonus                  1
&gt; 7 Paycheck Wages                      Sick/Holiday &amp; Vacation Pay     1</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="external-auditors.html#cb344-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb344-2"><a href="external-auditors.html#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> </span>
<span id="cb344-3"><a href="external-auditors.html#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(debit, credit), sum))</span></code></pre></div>
<pre><code>&gt; # A tibble: 12 x 3
&gt;    type                 debit  credit
&gt;  * &lt;chr&gt;                &lt;dbl&gt;   &lt;dbl&gt;
&gt;  1 Bill               147803. 147803.
&gt;  2 Bill Pmt -Check    131032. 131032.
&gt;  3 Check              216938. 216938.
&gt;  4 Credit Card Charge   3454.   3454.
&gt;  5 Deposit            375976. 375976.
&gt;  6 General Journal      9007.   9007.
&gt;  7 Inventory Adjust      375     375 
&gt;  8 Invoice            585165. 585165.
&gt;  9 Liability Check     12728.  12728.
&gt; 10 Paycheck           147576. 147576.
&gt; 11 Payment            375976. 375976.
&gt; 12 Transfer           130000  130000</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="external-auditors.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gl_df<span class="sc">$</span>type, gl_df<span class="sc">$</span>month) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>()</span></code></pre></div>
<pre><code>&gt;                     
&gt;                       Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov
&gt;   Bill                 32   19   11   25    4    8    6    9   15    7    9
&gt;   Bill Pmt -Check       0   12   12    8   10    6    8    6    2   10    6
&gt;   Check                56   49   35   54   45   43   53   55   39   48   45
&gt;   Credit Card Charge    6    6    4   10    4    2    6    4    8    6    8
&gt;   Deposit               8   10   11    5   12   15    0   16   11    8    0
&gt;   General Journal       4    6    6    6    6    6    6    6    6    6    6
&gt;   Inventory Adjust      0    0    0    0    0    0    0    0    0    0    0
&gt;   Invoice             197  230  175  218  374  348  312  220  113   73  166
&gt;   Liability Check       0    9    9    9   16    2    9    9    9    9    9
&gt;   Paycheck             40  104  103  101  103  105  104  103  108  107  100
&gt;   Payment               6   14   16   20   12   16   16   14   18   12   20
&gt;   Transfer              0    2    2    0    2    2    2    2    0    0    2
&gt;   Sum                 349  461  384  456  588  553  522  444  329  286  371
&gt;                     
&gt;                       Dec  Sum
&gt;   Bill                 21  166
&gt;   Bill Pmt -Check       4   84
&gt;   Check                37  559
&gt;   Credit Card Charge    4   68
&gt;   Deposit              15  111
&gt;   General Journal       8   72
&gt;   Inventory Adjust      2    2
&gt;   Invoice             206 2632
&gt;   Liability Check      21  111
&gt;   Paycheck            168 1246
&gt;   Payment              12  176
&gt;   Transfer              0   14
&gt;   Sum                 498 5241</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="external-auditors.html#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gl_df<span class="sc">$</span>type, gl_df<span class="sc">$</span>month) <span class="sc">%&gt;%</span> <span class="fu">margin.table</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>&gt; 
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt; 349 461 384 456 588 553 522 444 329 286 371 498</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="external-auditors.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(gl_df<span class="sc">$</span>month)</span></code></pre></div>
<pre><code>&gt; 
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt; 349 461 384 456 588 553 522 444 329 286 371 498</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="external-auditors.html#cb352-1" aria-hidden="true" tabindex="-1"></a>mytable <span class="ot">&lt;-</span> <span class="fu">table</span>(gl_df<span class="sc">$</span>quarter)                                            </span>
<span id="cb352-2"><a href="external-auditors.html#cb352-2" aria-hidden="true" tabindex="-1"></a>lbls <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="fu">names</span>(mytable), <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>, mytable, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb352-3"><a href="external-auditors.html#cb352-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(mytable, <span class="at">labels =</span> lbls, <span class="at">main =</span> <span class="st">&quot;Number of transactions</span><span class="sc">\n</span><span class="st"> (for each quarter)&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="external-auditors.html#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(<span class="sc">~</span> month <span class="sc">+</span> weekday, <span class="at">data =</span> gl_df, <span class="at">color =</span> <span class="cn">TRUE</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-155-1.png" width="672" /></p>
<p>Perform text analysis on the column of memo in terms of PCA and correlation.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="external-auditors.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">nchar</span>(gl_df<span class="sc">$</span>memo))</span></code></pre></div>
<pre><code>&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA&#39;s 
&gt;    3.00   17.00   38.00   37.84   50.00   96.00    1456</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="external-auditors.html#cb356-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb356-2"><a href="external-auditors.html#cb356-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(memo), <span class="fu">nchar</span>(memo) <span class="sc">&gt;</span> <span class="dv">95</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb356-3"><a href="external-auditors.html#cb356-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(memo)</span></code></pre></div>
<pre><code>&gt; [1] &quot;Commission on sales of $79,815.90 (see report) x 5%. January - June 2007. Based on a cash basis.&quot;</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="external-auditors.html#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb358-2"><a href="external-auditors.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud2)</span>
<span id="cb358-3"><a href="external-auditors.html#cb358-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-4"><a href="external-auditors.html#cb358-4" aria-hidden="true" tabindex="-1"></a>txt <span class="ot">&lt;-</span> gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb358-5"><a href="external-auditors.html#cb358-5" aria-hidden="true" tabindex="-1"></a>  tidytext<span class="sc">::</span><span class="fu">unnest_tokens</span>(word, memo) <span class="sc">%&gt;%</span> </span>
<span id="cb358-6"><a href="external-auditors.html#cb358-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(stop_words) <span class="sc">%&gt;%</span> </span>
<span id="cb358-7"><a href="external-auditors.html#cb358-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;[0-9]&quot;</span>)) </span>
<span id="cb358-8"><a href="external-auditors.html#cb358-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-9"><a href="external-auditors.html#cb358-9" aria-hidden="true" tabindex="-1"></a>txt <span class="sc">%&gt;%</span> </span>
<span id="cb358-10"><a href="external-auditors.html#cb358-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb358-11"><a href="external-auditors.html#cb358-11" aria-hidden="true" tabindex="-1"></a>  wordcloud2<span class="sc">::</span><span class="fu">wordcloud2</span>()</span></code></pre></div>
<div id="htmlwidget-f0b23fb3042882ae2295" style="width:672px;height:480px;" class="wordcloud2 html-widget"></div>
<script type="application/json" data-for="htmlwidget-f0b23fb3042882ae2295">{"x":{"word":["watt","glass","max","medium","light","base","brass","etched","pendant","finish","solid","white","collection","bulbs","specialty","satin","pack","polished","lamp","black","alabaster","ribbed","med","cand","cobblestone","lanterns","golden","acct","tapestry","marble","cracked","stage","studio","opal","watts","brushed","fluorescent","verde","bipin","bar","nickel","umber","hpf","faux","hanging","chestnut","policy","beveled","mirror","wall","halogen","pearl","nickle","verona","cast","die","sunset","acid","lantern","drop","frame","oak","textured","expense","desert","series","stone","broadway","chandelier","accents","burnished","domes","ht","frosted","taupe","athena","tubular","volts","copper","flat","seeded","antiqued","candelabra","latern","vianne","mount","baroque","tiffany","bronze","intensity","luminous","tail","inv","colonial","roman","supplies","brassguard","millstone","renaissance","chrome","insurance","report","car","cell","depr","draw","lease","payroll","rent","deposit","ins","credit","line","owner's","steel","acrylic","diffuser","flush","cash","computer","fee","exp","river","rock","petty","postage","employee","auto","health","funds","lunch","office","transfer","meter","rental","wc","fees","gen","liab","materials","monthly","set","gold","rpt","seminar","ad","bound","convention","kitchen","shipments","cust","june","annual","aug","checkup","coffee","fall","feb","id","journal","july","nov","oct","packaging","quarterly","sept","apr","company","dec","logo","mar","marketing","business","cards","client","dues","finished","holiday","promotional","custom","gas","guard","jan","professional","registration","sales","summer","tax","travel","april","balance","basis","blipping","brough","campaign","cartridges","corp","crimson","decorations","dome","donation","electrical","extra","file","flowers","flyers","gift","half","indoor","ink","january","jonathan","keys","letterhead","license","lighting","literature","march","owners","partial","party","personal","product","property","purple","quickbooks","repair","repairs","returns","ship","society","spring","staff","tape","trim","voltage","wire","air","based","boxes","catalog","commission","costs","exterior","fare","fax","february","fixture","janaury","jun","laptop","liability","machine","maintenance","mileage","paper","payment","printer","printing","reps","taxes","time"],"freq":[1921,1177,881,557,548,516,473,358,319,287,286,281,260,259,259,249,234,210,209,199,181,175,172,171,161,157,153,150,148,146,145,132,132,131,130,128,122,122,120,116,116,115,114,96,95,93,90,89,89,89,87,87,86,85,83,83,80,79,73,64,64,64,64,62,61,61,61,57,57,56,56,56,56,53,53,52,52,52,43,43,43,41,41,41,41,39,37,37,35,35,35,35,34,32,32,32,30,29,29,27,27,27,24,24,24,24,24,24,24,23,23,22,22,22,22,21,21,21,20,20,20,19,19,19,18,18,17,15,15,14,14,14,14,12,12,12,11,11,11,11,11,11,10,9,9,8,8,8,8,8,7,7,6,6,6,6,6,6,6,6,6,6,6,6,6,6,5,5,5,5,5,5,4,4,4,4,4,4,4,3,3,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"fontFamily":"Segoe UI","fontWeight":"bold","color":"random-dark","minSize":0,"weightFactor":0.0937011972930765,"backgroundColor":"white","gridSize":0,"minRotation":-0.785398163397448,"maxRotation":0.785398163397448,"shuffle":true,"rotateRatio":0.4,"shape":"circle","ellipticity":0.65,"figBase64":null,"hover":null},"evals":[],"jsHooks":{"render":[{"code":"function(el,x){\n                        console.log(123);\n                        if(!iii){\n                          window.location.reload();\n                          iii = False;\n\n                        }\n  }","data":null}]}}</script>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="external-auditors.html#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(widyr)</span>
<span id="cb359-2"><a href="external-auditors.html#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="external-auditors.html#cb359-3" aria-hidden="true" tabindex="-1"></a>txt_pca <span class="ot">&lt;-</span>  txt <span class="sc">%&gt;%</span> </span>
<span id="cb359-4"><a href="external-auditors.html#cb359-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb359-5"><a href="external-auditors.html#cb359-5" aria-hidden="true" tabindex="-1"></a>  widyr<span class="sc">::</span><span class="fu">widely_svd</span>(word, name, word, <span class="at">nv =</span> <span class="dv">6</span>) </span>
<span id="cb359-6"><a href="external-auditors.html#cb359-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-7"><a href="external-auditors.html#cb359-7" aria-hidden="true" tabindex="-1"></a>txt_pca <span class="sc">%&gt;%</span> </span>
<span id="cb359-8"><a href="external-auditors.html#cb359-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dimension <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb359-9"><a href="external-auditors.html#cb359-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(value))</span></code></pre></div>
<pre><code>&gt; # A tibble: 262 x 3
&gt;    word     dimension value
&gt;    &lt;chr&gt;        &lt;int&gt; &lt;dbl&gt;
&gt;  1 lanterns         1 0.172
&gt;  2 opal             1 0.169
&gt;  3 glass            1 0.168
&gt;  4 med              1 0.163
&gt;  5 white            1 0.160
&gt;  6 brass            1 0.158
&gt;  7 hpf              1 0.156
&gt;  8 marble           1 0.155
&gt;  9 satin            1 0.151
&gt; 10 pendant          1 0.142
&gt; # ... with 252 more rows</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="external-auditors.html#cb361-1" aria-hidden="true" tabindex="-1"></a>txt_pca <span class="sc">%&gt;%</span> </span>
<span id="cb361-2"><a href="external-auditors.html#cb361-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(dimension <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb361-3"><a href="external-auditors.html#cb361-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, <span class="fu">abs</span>(value)) <span class="sc">%&gt;%</span> </span>
<span id="cb361-4"><a href="external-auditors.html#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">fct_reorder</span>(word, value)) <span class="sc">%&gt;%</span></span>
<span id="cb361-5"><a href="external-auditors.html#cb361-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(value, word)) <span class="sc">+</span></span>
<span id="cb361-6"><a href="external-auditors.html#cb361-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-158-1.png" width="672" /></p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="external-auditors.html#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb362-2"><a href="external-auditors.html#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggraph)</span>
<span id="cb362-3"><a href="external-auditors.html#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb362-4"><a href="external-auditors.html#cb362-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-5"><a href="external-auditors.html#cb362-5" aria-hidden="true" tabindex="-1"></a>txt_cor <span class="ot">&lt;-</span> txt <span class="sc">%&gt;%</span> </span>
<span id="cb362-6"><a href="external-auditors.html#cb362-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>(word) <span class="sc">%&gt;%</span> </span>
<span id="cb362-7"><a href="external-auditors.html#cb362-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(n <span class="sc">&gt;=</span> <span class="dv">50</span>) <span class="sc">%&gt;%</span>                                 </span>
<span id="cb362-8"><a href="external-auditors.html#cb362-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, word) <span class="sc">%&gt;%</span> </span>
<span id="cb362-9"><a href="external-auditors.html#cb362-9" aria-hidden="true" tabindex="-1"></a>  widyr<span class="sc">::</span><span class="fu">pairwise_cor</span>(word, name, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span>           </span>
<span id="cb362-10"><a href="external-auditors.html#cb362-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(correlation <span class="sc">&lt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb362-11"><a href="external-auditors.html#cb362-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">100</span>)</span>
<span id="cb362-12"><a href="external-auditors.html#cb362-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-13"><a href="external-auditors.html#cb362-13" aria-hidden="true" tabindex="-1"></a>txt_cor <span class="sc">%&gt;%</span> </span>
<span id="cb362-14"><a href="external-auditors.html#cb362-14" aria-hidden="true" tabindex="-1"></a>  igraph<span class="sc">::</span><span class="fu">graph_from_data_frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb362-15"><a href="external-auditors.html#cb362-15" aria-hidden="true" tabindex="-1"></a>  ggraph<span class="sc">::</span><span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">&#39;kk&#39;</span>) <span class="sc">+</span> </span>
<span id="cb362-16"><a href="external-auditors.html#cb362-16" aria-hidden="true" tabindex="-1"></a>  ggraph<span class="sc">::</span><span class="fu">geom_edge_link</span>() <span class="sc">+</span></span>
<span id="cb362-17"><a href="external-auditors.html#cb362-17" aria-hidden="true" tabindex="-1"></a>  ggraph<span class="sc">::</span><span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb362-18"><a href="external-auditors.html#cb362-18" aria-hidden="true" tabindex="-1"></a>  ggraph<span class="sc">::</span><span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name), <span class="at">repel =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb362-19"><a href="external-auditors.html#cb362-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-159-1.png" width="672" /></p>
</div>
<div id="numberic" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Numberic</h3>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="external-auditors.html#cb363-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="ot">&lt;-</span> gl_df[gl_df<span class="sc">$</span>subaccount <span class="sc">==</span> <span class="st">&#39;Revenue&#39;</span>, ]</span></code></pre></div>
<p>The column of credit has no debit balance in this case. But, it has 0 credit amount, which could be an error.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="external-auditors.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(revenue, <span class="cf">function</span>(x) <span class="fu">length</span>(<span class="fu">which</span>(x <span class="sc">==</span> <span class="dv">0</span>)))</span></code></pre></div>
<pre><code>&gt;    account subaccount       type       date        num       name       memo 
&gt;          0          0          0          0          0          0          0 
&gt;      split      debit     credit    balance    weekday      month    quarter 
&gt;          0        847          5          0          0          0          0</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="external-auditors.html#cb366-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">sum</span>(.x <span class="sc">==</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>&gt; # A tibble: 1 x 14
&gt;   account subaccount  type  date   num  name  memo split debit credit balance
&gt;     &lt;int&gt;      &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;int&gt;   &lt;int&gt;
&gt; 1       0          0     0     0     0     0     0     0   847      5       0
&gt; # ... with 3 more variables: weekday &lt;int&gt;, month &lt;int&gt;, quarter &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="external-auditors.html#cb368-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> <span class="fu">map_df</span>(<span class="sc">~</span><span class="fu">mean</span>(.x <span class="sc">==</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>&gt; # A tibble: 1 x 14
&gt;   account subaccount  type  date   num  name  memo split debit  credit balance
&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
&gt; 1       0          0     0     0     0     0     0     0     1 0.00590       0
&gt; # ... with 3 more variables: weekday &lt;dbl&gt;, month &lt;dbl&gt;, quarter &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="external-auditors.html#cb370-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb370-2"><a href="external-auditors.html#cb370-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(debit <span class="sc">==</span> <span class="dv">0</span>, credit <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>&gt; # A tibble: 5 x 14
&gt;   account subaccount type    date       num   name    memo    split debit credit
&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 Revenue Revenue    Invoice 2018-11-29 71123 Kern L~ 18x8x1~ Acco~     0      0
&gt; 2 Revenue Revenue    Invoice 2018-11-29 71123 Kern L~ Burnis~ Acco~     0      0
&gt; 3 Revenue Revenue    Invoice 2018-11-29 71123 Kern L~ Tapest~ Acco~     0      0
&gt; 4 Revenue Revenue    Invoice 2018-12-03 71139 Lavery~ Cand. ~ Acco~     0      0
&gt; 5 Revenue Revenue    Invoice 2018-12-15 71140 Thomps~ Fluore~ Acco~     0      0
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="external-auditors.html#cb372-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span></span>
<span id="cb372-2"><a href="external-auditors.html#cb372-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">across</span>(<span class="fu">c</span>(debit, credit), <span class="sc">~</span>.x <span class="sc">==</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>&gt; # A tibble: 5 x 14
&gt;   account subaccount type    date       num   name    memo    split debit credit
&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 Revenue Revenue    Invoice 2018-11-29 71123 Kern L~ 18x8x1~ Acco~     0      0
&gt; 2 Revenue Revenue    Invoice 2018-11-29 71123 Kern L~ Burnis~ Acco~     0      0
&gt; 3 Revenue Revenue    Invoice 2018-11-29 71123 Kern L~ Tapest~ Acco~     0      0
&gt; 4 Revenue Revenue    Invoice 2018-12-03 71139 Lavery~ Cand. ~ Acco~     0      0
&gt; 5 Revenue Revenue    Invoice 2018-12-15 71140 Thomps~ Fluore~ Acco~     0      0
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<p>Analyze revenue at the level of month based on both frequency and amount.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="external-auditors.html#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by(revenue, revenue$month, summary)</span></span>
<span id="cb374-2"><a href="external-auditors.html#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(revenue<span class="sc">$</span>month) <span class="sc">%&gt;%</span> <span class="fu">prop.table</span>()</span></code></pre></div>
<pre><code>&gt; 
&gt;        Jan        Feb        Mar        Apr        May        Jun        Jul 
&gt; 0.07438017 0.08736718 0.06611570 0.08264463 0.14285714 0.13341204 0.11924439 
&gt;        Aug        Sep        Oct        Nov        Dec 
&gt; 0.08382527 0.04250295 0.02715466 0.06257379 0.07792208</code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="external-auditors.html#cb376-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(revenue) <span class="sc">+</span></span>
<span id="cb376-2"><a href="external-auditors.html#cb376-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(month), <span class="at">y =</span> <span class="fu">after_stat</span>(count <span class="sc">/</span> <span class="fu">sum</span>(count)))) <span class="sc">+</span></span>
<span id="cb376-3"><a href="external-auditors.html#cb376-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent, <span class="at">name =</span> <span class="st">&quot;Proportion&quot;</span>) <span class="sc">+</span></span>
<span id="cb376-4"><a href="external-auditors.html#cb376-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb376-5"><a href="external-auditors.html#cb376-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="external-auditors.html#cb377-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb377-2"><a href="external-auditors.html#cb377-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, credit)) <span class="sc">+</span></span>
<span id="cb377-3"><a href="external-auditors.html#cb377-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&#39;summary&#39;</span>, <span class="at">fun =</span> <span class="st">&quot;median&quot;</span>, <span class="at">fill =</span> <span class="st">&#39;steelblue&#39;</span>) <span class="sc">+</span></span>
<span id="cb377-4"><a href="external-auditors.html#cb377-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">stat =</span> <span class="st">&quot;count&quot;</span>, <span class="fu">aes</span>(<span class="at">y =</span> ..count.., <span class="at">label =</span> ..count..)) <span class="sc">+</span></span>
<span id="cb377-5"><a href="external-auditors.html#cb377-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">600</span>, <span class="at">by =</span> <span class="dv">100</span>), <span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb377-6"><a href="external-auditors.html#cb377-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb377-7"><a href="external-auditors.html#cb377-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="external-auditors.html#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(revenue, <span class="fu">tapply</span>(credit, month, <span class="cf">function</span>(x) {<span class="fu">c</span>(<span class="fu">min</span>(x) , <span class="fu">max</span>(x))}))</span></code></pre></div>
<pre><code>&gt; $Jan
&gt; [1]    4.95 8400.00
&gt; 
&gt; $Feb
&gt; [1]    4.95 1980.00
&gt; 
&gt; $Mar
&gt; [1]    9.9 5600.0
&gt; 
&gt; $Apr
&gt; [1]     4.95 12600.00
&gt; 
&gt; $May
&gt; [1]    4.95 6750.00
&gt; 
&gt; $Jun
&gt; [1]    4.95 4500.00
&gt; 
&gt; $Jul
&gt; [1]   13.5 7875.0
&gt; 
&gt; $Aug
&gt; [1]   19.8 5000.0
&gt; 
&gt; $Sep
&gt; [1]   35.1 6300.0
&gt; 
&gt; $Oct
&gt; [1]   50 6300
&gt; 
&gt; $Nov
&gt; [1]    0 4700
&gt; 
&gt; $Dec
&gt; [1]    0 8100</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="external-auditors.html#cb380-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb380-2"><a href="external-auditors.html#cb380-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span> </span>
<span id="cb380-3"><a href="external-auditors.html#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(credit)) <span class="sc">%&gt;%</span> </span>
<span id="cb380-4"><a href="external-auditors.html#cb380-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">n</span>())) </span></code></pre></div>
<pre><code>&gt; # A tibble: 24 x 14
&gt; # Groups:   month [12]
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0 8.4 e3
&gt;  2 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Haloge~ Acco~     0 4.95e0
&gt;  3 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ 18x8x1~ Acco~     0 1.98e3
&gt;  4 Revenue Revenue    Invoice 2018-02-12 71088 Cole ~ Haloge~ Acco~     0 4.95e0
&gt;  5 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Cand. ~ Acco~     0 5.6 e3
&gt;  6 Revenue Revenue    Invoice 2018-03-27 71060 Godwi~ Haloge~ Acco~     0 9.9 e0
&gt;  7 Revenue Revenue    Invoice 2018-04-13 71126 Kern ~ Golden~ Acco~     0 1.26e4
&gt;  8 Revenue Revenue    Invoice 2018-04-16 71087 Cole ~ Haloge~ Acco~     0 4.95e0
&gt;  9 Revenue Revenue    Invoice 2018-05-22 71127 Kern ~ Domes,~ Acco~     0 6.75e3
&gt; 10 Revenue Revenue    Invoice 2018-05-24 71086 Cole ~ Haloge~ Acco~     0 4.95e0
&gt; # ... with 14 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="external-auditors.html#cb382-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb382-2"><a href="external-auditors.html#cb382-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month) <span class="sc">%&gt;%</span> </span>
<span id="cb382-3"><a href="external-auditors.html#cb382-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">monthly_sales =</span> <span class="fu">sum</span>(credit), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb382-4"><a href="external-auditors.html#cb382-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">accumlated_sales =</span> <span class="fu">cumsum</span>(monthly_sales))</span></code></pre></div>
<pre><code>&gt; # A tibble: 12 x 3
&gt;    month monthly_sales accumlated_sales
&gt;  * &lt;ord&gt;         &lt;dbl&gt;            &lt;dbl&gt;
&gt;  1 Jan          25507.           25507.
&gt;  2 Feb          25795.           51302.
&gt;  3 Mar          30483.           81786.
&gt;  4 Apr          32325.          114111.
&gt;  5 May          29839.          143950.
&gt;  6 Jun          31883.          175833.
&gt;  7 Jul          39460.          215294.
&gt;  8 Aug          31809.          247103.
&gt;  9 Sep          29191.          276294.
&gt; 10 Oct          28512.          304806.
&gt; 11 Nov          39128           343934.
&gt; 12 Dec          67876.          411810.</code></pre>
<p>Analyze revenue at the level of weekday based on both frequency and amount. The result indicates a cutoff problem or possible fraud as most of transactions are posted on weekends.
1. Frequency: Jan (Sun, Sat) 63% and Dec (Sat) 62%.
2. Amount: Jan (Sun, Sat) 51% and Dec (Sat) 46%.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="external-auditors.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(revenue, <span class="fu">table</span>(month, weekday)) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>()</span></code></pre></div>
<pre><code>&gt;      weekday
&gt; month Sun Mon Tue Wed Thu Fri Sat Sum
&gt;   Jan  30   1   0  16   6   0  10  63
&gt;   Feb  16  17  16   8   6   5   6  74
&gt;   Mar   8  23  10   9   6   0   0  56
&gt;   Apr  14  17  13   5   0   1  20  70
&gt;   May   0   0   3  49  45  14  10 121
&gt;   Jun  10  14  46   0  29  14   0 113
&gt;   Jul   0  27  28   0  29  17   0 101
&gt;   Aug   0   0   3   4   4  60   0  71
&gt;   Sep   0   0  16   5   0  15   0  36
&gt;   Oct   0  11   5   0   4   3   0  23
&gt;   Nov   0  19   5   0  18  11   0  53
&gt;   Dec   0  14   0   5   0   6  41  66
&gt;   Sum  78 143 145 101 147 146  87 847</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="external-auditors.html#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(revenue<span class="sc">$</span>month, revenue<span class="sc">$</span>weekday) <span class="sc">%&gt;%</span> <span class="fu">prop.table</span>(<span class="at">margin =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">addmargins</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>&gt;      
&gt;        Sun  Mon  Tue  Wed  Thu  Fri  Sat  Sum
&gt;   Jan 0.48 0.02 0.00 0.25 0.10 0.00 0.16 1.01
&gt;   Feb 0.22 0.23 0.22 0.11 0.08 0.07 0.08 1.01
&gt;   Mar 0.14 0.41 0.18 0.16 0.11 0.00 0.00 1.00
&gt;   Apr 0.20 0.24 0.19 0.07 0.00 0.01 0.29 1.00
&gt;   May 0.00 0.00 0.02 0.40 0.37 0.12 0.08 0.99
&gt;   Jun 0.09 0.12 0.41 0.00 0.26 0.12 0.00 1.00
&gt;   Jul 0.00 0.27 0.28 0.00 0.29 0.17 0.00 1.01
&gt;   Aug 0.00 0.00 0.04 0.06 0.06 0.85 0.00 1.01
&gt;   Sep 0.00 0.00 0.44 0.14 0.00 0.42 0.00 1.00
&gt;   Oct 0.00 0.48 0.22 0.00 0.17 0.13 0.00 1.00
&gt;   Nov 0.00 0.36 0.09 0.00 0.34 0.21 0.00 1.00
&gt;   Dec 0.00 0.21 0.00 0.08 0.00 0.09 0.62 1.00</code></pre>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="external-auditors.html#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(revenue<span class="sc">$</span>month, revenue<span class="sc">$</span>weekday) <span class="sc">%&gt;%</span> <span class="fu">margin.table</span>(<span class="dv">1</span>)</span></code></pre></div>
<pre><code>&gt; 
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;  63  74  56  70 121 113 101  71  36  23  53  66</code></pre>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="external-auditors.html#cb390-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(revenue<span class="sc">$</span>month, revenue<span class="sc">$</span>weekday) <span class="sc">%&gt;%</span> <span class="fu">margin.table</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>&gt; 
&gt; Sun Mon Tue Wed Thu Fri Sat 
&gt;  78 143 145 101 147 146  87</code></pre>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="external-auditors.html#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(revenue<span class="sc">$</span>month, revenue<span class="sc">$</span>weekday, summary)                             </span></code></pre></div>
<pre><code>&gt; revenue$weekday: Sun
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;  30  16   8  14   0  10   0   0   0   0   0   0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Mon
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;   1  17  23  17   0  14  27   0   0  11  19  14 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Tue
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;   0  16  10  13   3  46  28   3  16   5   5   0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Wed
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;  16   8   9   5  49   0   0   4   5   0   0   5 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Thu
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;   6   6   6   0  45  29  29   4   0   4  18   0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Fri
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;   0   5   0   1  14  14  17  60  15   3  11   6 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Sat
&gt; Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec 
&gt;  10   6   0  20  10   0   0   0   0   0   0  41</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="external-auditors.html#cb394-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb394-2"><a href="external-auditors.html#cb394-2" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">tabyl</span>(month, weekday) <span class="sc">%&gt;%</span> </span>
<span id="cb394-3"><a href="external-auditors.html#cb394-3" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_totals</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb394-4"><a href="external-auditors.html#cb394-4" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_percentages</span>(<span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span>                                </span>
<span id="cb394-5"><a href="external-auditors.html#cb394-5" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb394-6"><a href="external-auditors.html#cb394-6" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_ns</span>(<span class="st">&quot;front&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb394-7"><a href="external-auditors.html#cb394-7" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_title</span>(<span class="st">&quot;combined&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb394-8"><a href="external-auditors.html#cb394-8" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_rounding</span>(<span class="at">digits =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>&gt;  month/weekday        Sun         Mon         Tue         Wed         Thu
&gt;            Jan 30 (47.6%)   1  (1.6%)   0  (0.0%)  16 (25.4%)   6  (9.5%)
&gt;            Feb 16 (21.6%)  17 (23.0%)  16 (21.6%)   8 (10.8%)   6  (8.1%)
&gt;            Mar  8 (14.3%)  23 (41.1%)  10 (17.9%)   9 (16.1%)   6 (10.7%)
&gt;            Apr 14 (20.0%)  17 (24.3%)  13 (18.6%)   5  (7.1%)   0  (0.0%)
&gt;            May  0  (0.0%)   0  (0.0%)   3  (2.5%)  49 (40.5%)  45 (37.2%)
&gt;            Jun 10  (8.8%)  14 (12.4%)  46 (40.7%)   0  (0.0%)  29 (25.7%)
&gt;            Jul  0  (0.0%)  27 (26.7%)  28 (27.7%)   0  (0.0%)  29 (28.7%)
&gt;            Aug  0  (0.0%)   0  (0.0%)   3  (4.2%)   4  (5.6%)   4  (5.6%)
&gt;            Sep  0  (0.0%)   0  (0.0%)  16 (44.4%)   5 (13.9%)   0  (0.0%)
&gt;            Oct  0  (0.0%)  11 (47.8%)   5 (21.7%)   0  (0.0%)   4 (17.4%)
&gt;            Nov  0  (0.0%)  19 (35.8%)   5  (9.4%)   0  (0.0%)  18 (34.0%)
&gt;            Dec  0  (0.0%)  14 (21.2%)   0  (0.0%)   5  (7.6%)   0  (0.0%)
&gt;          Total 78  (9.2%) 143 (16.9%) 145 (17.1%) 101 (11.9%) 147 (17.4%)
&gt;          Fri        Sat
&gt;    0  (0.0%) 10 (15.9%)
&gt;    5  (6.8%)  6  (8.1%)
&gt;    0  (0.0%)  0  (0.0%)
&gt;    1  (1.4%) 20 (28.6%)
&gt;   14 (11.6%) 10  (8.3%)
&gt;   14 (12.4%)  0  (0.0%)
&gt;   17 (16.8%)  0  (0.0%)
&gt;   60 (84.5%)  0  (0.0%)
&gt;   15 (41.7%)  0  (0.0%)
&gt;    3 (13.0%)  0  (0.0%)
&gt;   11 (20.8%)  0  (0.0%)
&gt;    6  (9.1%) 41 (62.1%)
&gt;  146 (17.2%) 87 (10.3%)</code></pre>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="external-auditors.html#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="fu">by</span>(revenue<span class="sc">$</span>credit, revenue<span class="sc">$</span>weekday, summary)                            </span></code></pre></div>
<pre><code>&gt; revenue$weekday: Sun
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;    4.95   75.60  224.00  433.91  468.75 4500.00 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Mon
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;     0.0    75.6   135.0   353.7   341.0  8400.0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Tue
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;     9.0    84.0   180.0   511.8   405.0  7875.0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Wed
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;     9.9    90.0   285.0   755.5   600.0  8100.0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Thu
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;     0.0    75.6   129.6   362.0   300.0  4700.0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Fri
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;    13.5    63.0   135.0   501.9   270.0 12600.0 
&gt; ------------------------------------------------------------ 
&gt; revenue$weekday: Sat
&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;     0.0    94.5   300.0   579.1   577.5  7000.0</code></pre>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="external-auditors.html#cb398-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describeBy</span>(revenue<span class="sc">$</span>credit, revenue<span class="sc">$</span>weekday, <span class="at">mat =</span> <span class="cn">TRUE</span>)  </span></code></pre></div>
<pre><code>&gt;     item group1 vars   n     mean        sd median  trimmed      mad   min
&gt; X11    1    Sun    1  78 433.9077  684.9086  224.0 284.1289 255.7114  4.95
&gt; X12    2    Mon    1 143 353.6741  807.0311  135.0 207.3822 167.5338  0.00
&gt; X13    3    Tue    1 145 511.8241 1167.9991  180.0 247.6325 178.8016  9.00
&gt; X14    4    Wed    1 101 755.5332 1436.2487  285.0 365.9401 311.3460  9.90
&gt; X15    5    Thu    1 147 361.9544  686.0834  129.6 201.3807 158.7865  0.00
&gt; X16    6    Fri    1 146 501.9095 1359.8335  135.0 197.0905 133.4340 13.50
&gt; X17    7    Sat    1  87 579.0793  961.5876  300.0 378.8092 324.6894  0.00
&gt;       max    range     skew  kurtosis        se
&gt; X11  4500  4495.05 3.457969 15.017371  77.55063
&gt; X12  8400  8400.00 7.451695 67.636480  67.48733
&gt; X13  7875  7866.00 4.489303 21.141764  96.99705
&gt; X14  8100  8090.10 3.048351  9.366994 142.91209
&gt; X15  4700  4700.00 3.970806 17.436018  56.58721
&gt; X16 12600 12586.50 6.006404 44.221777 112.54062
&gt; X17  7000  7000.00 3.968410 21.091200 103.09301</code></pre>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="external-auditors.html#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(credit <span class="sc">~</span> month <span class="sc">+</span> weekday, revenue) <span class="sc">%&gt;%</span> <span class="fu">ftable</span>() </span></code></pre></div>
<pre><code>&gt;       weekday      Sun      Mon      Tue      Wed      Thu      Fri      Sat
&gt; month                                                                       
&gt; Jan           10827.85  8400.00     0.00  2771.95  1126.00     0.00  2381.00
&gt; Feb            4391.00  2187.45  3185.00  2991.00  6745.00  1932.00  4364.00
&gt; Mar            1872.00  7273.45  1687.95 17429.00  2221.00     0.00     0.00
&gt; Apr            2578.95  2187.45  2926.95  1563.00     0.00 12600.00 10468.95
&gt; May               0.00     0.00  8756.00 11354.90  6403.50  1637.10  1687.95
&gt; Jun           14175.00  2578.95  8279.35     0.00  5212.45  1637.10     0.00
&gt; Jul               0.00  5163.40 22491.25     0.00  3646.35  8159.25     0.00
&gt; Aug               0.00     0.00  2085.00 13300.00  8000.00  8424.45     0.00
&gt; Sep               0.00     0.00 21484.00  5569.00     0.00  2138.40     0.00
&gt; Oct               0.00 10723.60  1719.00     0.00  1714.00 14355.00     0.00
&gt; Nov               0.00  7674.00  1600.00     0.00 18139.00 11715.00     0.00
&gt; Dec               0.00  4387.10     0.00 21330.00     0.00 10680.48 31478.00</code></pre>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="external-auditors.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(credit <span class="sc">~</span> month <span class="sc">+</span> weekday, revenue) <span class="sc">%&gt;%</span> <span class="fu">ftable</span>() <span class="sc">%&gt;%</span> <span class="fu">prop.table</span>(<span class="at">margin =</span> <span class="dv">1</span>)  <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>)</span></code></pre></div>
<pre><code>&gt;       weekday  Sun  Mon  Tue  Wed  Thu  Fri  Sat
&gt; month                                           
&gt; Jan           0.42 0.33 0.00 0.11 0.04 0.00 0.09
&gt; Feb           0.17 0.08 0.12 0.12 0.26 0.07 0.17
&gt; Mar           0.06 0.24 0.06 0.57 0.07 0.00 0.00
&gt; Apr           0.08 0.07 0.09 0.05 0.00 0.39 0.32
&gt; May           0.00 0.00 0.29 0.38 0.21 0.05 0.06
&gt; Jun           0.44 0.08 0.26 0.00 0.16 0.05 0.00
&gt; Jul           0.00 0.13 0.57 0.00 0.09 0.21 0.00
&gt; Aug           0.00 0.00 0.07 0.42 0.25 0.26 0.00
&gt; Sep           0.00 0.00 0.74 0.19 0.00 0.07 0.00
&gt; Oct           0.00 0.38 0.06 0.00 0.06 0.50 0.00
&gt; Nov           0.00 0.20 0.04 0.00 0.46 0.30 0.00
&gt; Dec           0.00 0.06 0.00 0.31 0.00 0.16 0.46</code></pre>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="external-auditors.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xtabs</span>(credit <span class="sc">~</span> month <span class="sc">+</span> weekday, revenue) <span class="sc">%&gt;%</span> <span class="fu">ftable</span>() <span class="sc">%&gt;%</span> <span class="fu">summary</span>()     </span></code></pre></div>
<pre><code>&gt;        V1              V2              V3              V4       
&gt;  Min.   :    0   Min.   :    0   Min.   :    0   Min.   :    0  
&gt;  1st Qu.:    0   1st Qu.: 1641   1st Qu.: 1666   1st Qu.:    0  
&gt;  Median :    0   Median : 3483   Median : 2506   Median : 2881  
&gt;  Mean   : 2820   Mean   : 4215   Mean   : 6185   Mean   : 6359  
&gt;  3rd Qu.: 3032   3rd Qu.: 7374   3rd Qu.: 8399   3rd Qu.:11841  
&gt;  Max.   :14175   Max.   :10724   Max.   :22491   Max.   :21330  
&gt;        V5                V6              V7       
&gt;  Min.   :    0.0   Min.   :    0   Min.   :    0  
&gt;  1st Qu.:  844.5   1st Qu.: 1637   1st Qu.:    0  
&gt;  Median : 2933.7   Median : 5149   Median :    0  
&gt;  Mean   : 4433.9   Mean   : 6107   Mean   : 4198  
&gt;  3rd Qu.: 6488.9   3rd Qu.:10939   3rd Qu.: 2877  
&gt;  Max.   :18139.0   Max.   :14355   Max.   :31478</code></pre>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="external-auditors.html#cb406-1" aria-hidden="true" tabindex="-1"></a>table1<span class="sc">::</span><span class="fu">table1</span>(<span class="sc">~</span>credit <span class="sc">+</span> weekday <span class="sc">|</span> quarter, <span class="at">data =</span> revenue)</span></code></pre></div>
<div class="Rtable1"><table class="Rtable1">
<thead>
<tr>
<th class='rowlabel firstrow lastrow'></th>
<th class='firstrow lastrow'><span class='stratlabel'>1<br><span class='stratn'>(N=193)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>2<br><span class='stratn'>(N=304)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>3<br><span class='stratn'>(N=208)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>4<br><span class='stratn'>(N=142)</span></span></th>
<th class='firstrow lastrow'><span class='stratlabel'>Overall<br><span class='stratn'>(N=847)</span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>credit</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Mean (SD)</td>
<td>424 (871)</td>
<td>309 (907)</td>
<td>483 (1080)</td>
<td>954 (1420)</td>
<td>486 (1070)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Median [Min, Max]</td>
<td class='lastrow'>210 [4.95, 8400]</td>
<td class='lastrow'>119 [4.95, 12600]</td>
<td class='lastrow'>162 [13.5, 7880]</td>
<td class='lastrow'>420 [0, 8100]</td>
<td class='lastrow'>171 [0, 12600]</td>
</tr>
<tr>
<td class='rowlabel firstrow'><span class='varlabel'>weekday</span></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
<td class='firstrow'></td>
</tr>
<tr>
<td class='rowlabel'>Sun</td>
<td>54 (28.0%)</td>
<td>24 (7.9%)</td>
<td>0 (0%)</td>
<td>0 (0%)</td>
<td>78 (9.2%)</td>
</tr>
<tr>
<td class='rowlabel'>Mon</td>
<td>41 (21.2%)</td>
<td>31 (10.2%)</td>
<td>27 (13.0%)</td>
<td>44 (31.0%)</td>
<td>143 (16.9%)</td>
</tr>
<tr>
<td class='rowlabel'>Tue</td>
<td>26 (13.5%)</td>
<td>62 (20.4%)</td>
<td>47 (22.6%)</td>
<td>10 (7.0%)</td>
<td>145 (17.1%)</td>
</tr>
<tr>
<td class='rowlabel'>Wed</td>
<td>33 (17.1%)</td>
<td>54 (17.8%)</td>
<td>9 (4.3%)</td>
<td>5 (3.5%)</td>
<td>101 (11.9%)</td>
</tr>
<tr>
<td class='rowlabel'>Thu</td>
<td>18 (9.3%)</td>
<td>74 (24.3%)</td>
<td>33 (15.9%)</td>
<td>22 (15.5%)</td>
<td>147 (17.4%)</td>
</tr>
<tr>
<td class='rowlabel'>Fri</td>
<td>5 (2.6%)</td>
<td>29 (9.5%)</td>
<td>92 (44.2%)</td>
<td>20 (14.1%)</td>
<td>146 (17.2%)</td>
</tr>
<tr>
<td class='rowlabel lastrow'>Sat</td>
<td class='lastrow'>16 (8.3%)</td>
<td class='lastrow'>30 (9.9%)</td>
<td class='lastrow'>0 (0%)</td>
<td class='lastrow'>41 (28.9%)</td>
<td class='lastrow'>87 (10.3%)</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="external-auditors.html#cb407-1" aria-hidden="true" tabindex="-1"></a>vcd<span class="sc">::</span><span class="fu">assocstats</span>(<span class="fu">table</span>(revenue<span class="sc">$</span>month, revenue<span class="sc">$</span>weekday))</span></code></pre></div>
<pre><code>&gt;                     X^2 df P(&gt; X^2)
&gt; Likelihood Ratio 1024.7 66        0
&gt; Pearson          1085.6 66        0
&gt; 
&gt; Phi-Coefficient   : NA 
&gt; Contingency Coeff.: 0.749 
&gt; Cramer&#39;s V        : 0.462</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="external-auditors.html#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kappa</span>(<span class="fu">table</span>(revenue<span class="sc">$</span>month, revenue<span class="sc">$</span>weekday))</span></code></pre></div>
<pre><code>&gt; [1] 8.449534</code></pre>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="external-auditors.html#cb411-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb411-2"><a href="external-auditors.html#cb411-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-3"><a href="external-auditors.html#cb411-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> revenue <span class="sc">%&gt;%</span></span>
<span id="cb411-4"><a href="external-auditors.html#cb411-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">fct_relevel</span>(weekday, <span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb411-5"><a href="external-auditors.html#cb411-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, weekday) <span class="sc">%&gt;%</span></span>
<span id="cb411-6"><a href="external-auditors.html#cb411-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb411-7"><a href="external-auditors.html#cb411-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, weekday, <span class="at">fill =</span> n)) <span class="sc">+</span></span>
<span id="cb411-8"><a href="external-auditors.html#cb411-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;#1D2024&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-9"><a href="external-auditors.html#cb411-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-10"><a href="external-auditors.html#cb411-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb411-11"><a href="external-auditors.html#cb411-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb411-12"><a href="external-auditors.html#cb411-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-13"><a href="external-auditors.html#cb411-13" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> revenue <span class="sc">%&gt;%</span></span>
<span id="cb411-14"><a href="external-auditors.html#cb411-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">fct_relevel</span>(weekday, <span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb411-15"><a href="external-auditors.html#cb411-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, weekday) <span class="sc">%&gt;%</span></span>
<span id="cb411-16"><a href="external-auditors.html#cb411-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">amt =</span> <span class="fu">sum</span>(credit), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb411-17"><a href="external-auditors.html#cb411-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, weekday, <span class="at">fill =</span> amt)) <span class="sc">+</span></span>
<span id="cb411-18"><a href="external-auditors.html#cb411-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;#1D2024&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb411-19"><a href="external-auditors.html#cb411-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;B&quot;</span>, </span>
<span id="cb411-20"><a href="external-auditors.html#cb411-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10000</span>, <span class="dv">30000</span>, <span class="dv">10000</span>),</span>
<span id="cb411-21"><a href="external-auditors.html#cb411-21" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;10K&quot;</span>, <span class="st">&quot;20K&quot;</span>, <span class="st">&quot;30K&quot;</span>)) <span class="sc">+</span></span>
<span id="cb411-22"><a href="external-auditors.html#cb411-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() <span class="sc">+</span></span>
<span id="cb411-23"><a href="external-auditors.html#cb411-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb411-24"><a href="external-auditors.html#cb411-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb411-25"><a href="external-auditors.html#cb411-25" aria-hidden="true" tabindex="-1"></a>(p1<span class="sc">/</span>p2) <span class="sc">+</span></span>
<span id="cb411-26"><a href="external-auditors.html#cb411-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guide =</span> <span class="st">&#39;collect&#39;</span>) <span class="sc">+</span></span>
<span id="cb411-27"><a href="external-auditors.html#cb411-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_annotation</span>(<span class="at">title =</span> <span class="st">&quot;The number of Journal voucher posted on weekends&quot;</span>, </span>
<span id="cb411-28"><a href="external-auditors.html#cb411-28" aria-hidden="true" tabindex="-1"></a>                  <span class="at">caption =</span> <span class="st">&quot;RAudit Solution LLP</span><span class="sc">\n</span><span class="st">https://stewartli.github.io/tailwindcss/&quot;</span>) <span class="sc">&amp;</span></span>
<span id="cb411-29"><a href="external-auditors.html#cb411-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#1D2024&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#1D2024&quot;</span>),</span>
<span id="cb411-30"><a href="external-auditors.html#cb411-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#1D2024&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#1D2024&quot;</span>),</span>
<span id="cb411-31"><a href="external-auditors.html#cb411-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#1D2024&quot;</span>, <span class="at">color =</span> <span class="st">&quot;#1D2024&quot;</span>),</span>
<span id="cb411-32"><a href="external-auditors.html#cb411-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#FAFAFA&quot;</span>),</span>
<span id="cb411-33"><a href="external-auditors.html#cb411-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;#FAFAFA&quot;</span>),</span>
<span id="cb411-34"><a href="external-auditors.html#cb411-34" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">1</span>),</span>
<span id="cb411-35"><a href="external-auditors.html#cb411-35" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>, </span>
<span id="cb411-36"><a href="external-auditors.html#cb411-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb411-37"><a href="external-auditors.html#cb411-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb411-38"><a href="external-auditors.html#cb411-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.line =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb411-39"><a href="external-auditors.html#cb411-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb411-40"><a href="external-auditors.html#cb411-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb411-41"><a href="external-auditors.html#cb411-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="external-auditors.html#cb412-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/calender.png&quot;</span>)</span></code></pre></div>
<p><img src="img/calender.png" width="960" /></p>
<p>Calculate statistical descriptive summary of the column of credit. Its log10 transformation is normal distribution.</p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="external-auditors.html#cb413-1" aria-hidden="true" tabindex="-1"></a>psych<span class="sc">::</span><span class="fu">describe</span>(revenue<span class="sc">$</span>credit)</span></code></pre></div>
<pre><code>&gt;    vars   n  mean      sd median trimmed    mad min   max range skew kurtosis
&gt; X1    1 847 486.2 1065.75    171  244.28 180.14   0 12600 12600 5.31    36.81
&gt;       se
&gt; X1 36.62</code></pre>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="external-auditors.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(revenue<span class="sc">$</span>credit)</span></code></pre></div>
<pre><code>&gt; [1] 1135823</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb417-1"><a href="external-auditors.html#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(revenue<span class="sc">$</span>credit, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">by =</span> .<span class="dv">1</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>&gt;       0%      10%      20%      30%      40%      50%      60%      70% 
&gt;     0.00    29.25    56.00    88.00   118.80   171.00   270.00   324.00 
&gt;      80%      90%     100% 
&gt;   534.40   981.00 12600.00</code></pre>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="external-auditors.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(revenue<span class="sc">$</span>credit)</span></code></pre></div>
<pre><code>&gt; [1] 291.6</code></pre>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="external-auditors.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(revenue<span class="sc">$</span>credit)</span></code></pre></div>
<pre><code>&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
&gt;     0.0    75.6   171.0   486.2   367.2 12600.0</code></pre>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="external-auditors.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fivenum</span>(revenue<span class="sc">$</span>credit)                                                </span></code></pre></div>
<pre><code>&gt; [1]     0.0    75.6   171.0   367.2 12600.0</code></pre>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="external-auditors.html#cb425-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb425-2"><a href="external-auditors.html#cb425-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">ntile</span>(credit, <span class="dv">50</span>) <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>&gt; # A tibble: 17 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Haloge~ Acco~     0   4.95
&gt;  2 Revenue Revenue    Invoice 2018-01-31 71059 Godwi~ Haloge~ Acco~     0   9.9 
&gt;  3 Revenue Revenue    Invoice 2018-02-12 71088 Cole ~ Haloge~ Acco~     0   4.95
&gt;  4 Revenue Revenue    Invoice 2018-02-27 71052 Baker~ Fluore~ Acco~     0   9   
&gt;  5 Revenue Revenue    Invoice 2018-03-27 71060 Godwi~ Haloge~ Acco~     0   9.9 
&gt;  6 Revenue Revenue    Invoice 2018-04-16 71087 Cole ~ Haloge~ Acco~     0   4.95
&gt;  7 Revenue Revenue    Invoice 2018-04-17 71061 Godwi~ Haloge~ Acco~     0   9.9 
&gt;  8 Revenue Revenue    Invoice 2018-05-02 71062 Godwi~ Haloge~ Acco~     0   9.9 
&gt;  9 Revenue Revenue    Invoice 2018-05-19 71063 Godwi~ Haloge~ Acco~     0   9.9 
&gt; 10 Revenue Revenue    Invoice 2018-05-24 71086 Cole ~ Haloge~ Acco~     0   4.95
&gt; 11 Revenue Revenue    Invoice 2018-06-07 71085 Cole ~ Haloge~ Acco~     0   4.95
&gt; 12 Revenue Revenue    Invoice 2018-11-29 71123 Kern ~ 18x8x1~ Acco~     0   0   
&gt; 13 Revenue Revenue    Invoice 2018-11-29 71123 Kern ~ Burnis~ Acco~     0   0   
&gt; 14 Revenue Revenue    Invoice 2018-11-29 71123 Kern ~ Tapest~ Acco~     0   0   
&gt; 15 Revenue Revenue    Invoice 2018-12-03 71139 Laver~ Haloge~ Acco~     0   9.35
&gt; 16 Revenue Revenue    Invoice 2018-12-03 71139 Laver~ Cand. ~ Acco~     0   0   
&gt; 17 Revenue Revenue    Invoice 2018-12-15 71140 Thomp~ Fluore~ Acco~     0   0   
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="external-auditors.html#cb427-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb427-2"><a href="external-auditors.html#cb427-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">between</span>(credit, <span class="dv">5000</span>, <span class="dv">10000</span>))</span></code></pre></div>
<pre><code>&gt; # A tibble: 12 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0   8400
&gt;  2 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Cand. ~ Acco~     0   5600
&gt;  3 Revenue Revenue    Invoice 2018-05-22 71127 Kern ~ Domes,~ Acco~     0   6750
&gt;  4 Revenue Revenue    Invoice 2018-07-17 71129 Kern ~ Golden~ Acco~     0   7875
&gt;  5 Revenue Revenue    Invoice 2018-08-22 71109 Dan A~ Vianne~ Acco~     0   5000
&gt;  6 Revenue Revenue    Invoice 2018-09-25 71107 Stern~ White,~ Acco~     0   5760
&gt;  7 Revenue Revenue    Invoice 2018-09-25 71107 Stern~ Sunset~ Acco~     0   6300
&gt;  8 Revenue Revenue    Invoice 2018-10-26 71108 Stern~ Sunset~ Acco~     0   6300
&gt;  9 Revenue Revenue    Invoice 2018-10-26 71108 Stern~ White,~ Acco~     0   5760
&gt; 10 Revenue Revenue    Invoice 2018-12-12 71106 Stern~ Sunset~ Acco~     0   6300
&gt; 11 Revenue Revenue    Invoice 2018-12-12 71106 Stern~ Domes,~ Acco~     0   8100
&gt; 12 Revenue Revenue    Invoice 2018-12-15 71137 Dan A~ Custom~ Acco~     0   7000
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="external-auditors.html#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2021</span>)</span>
<span id="cb429-2"><a href="external-auditors.html#cb429-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb429-3"><a href="external-auditors.html#cb429-3" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb429-4"><a href="external-auditors.html#cb429-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_sample</span>(<span class="at">prop =</span> .<span class="dv">9</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb429-5"><a href="external-auditors.html#cb429-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">sum</span>(credit))                                                     </span></code></pre></div>
<pre><code>&gt; # A tibble: 1 x 1
&gt;   `sum(credit)`
&gt;           &lt;dbl&gt;
&gt; 1       379895.</code></pre>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="external-auditors.html#cb431-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb431-2"><a href="external-auditors.html#cb431-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">log10</span>(credit))) <span class="sc">+</span></span>
<span id="cb431-3"><a href="external-auditors.html#cb431-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>() <span class="sc">+</span></span>
<span id="cb431-4"><a href="external-auditors.html#cb431-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-178-1.png" width="672" /></p>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="external-auditors.html#cb432-1" aria-hidden="true" tabindex="-1"></a>getPalette <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">&quot;Set2&quot;</span>))(<span class="dv">12</span>) </span>
<span id="cb432-2"><a href="external-auditors.html#cb432-2" aria-hidden="true" tabindex="-1"></a>lb <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">-</span> <span class="fu">sd</span>(x)</span>
<span id="cb432-3"><a href="external-auditors.html#cb432-3" aria-hidden="true" tabindex="-1"></a>ub <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(x) <span class="sc">+</span> <span class="fu">sd</span>(x)</span>
<span id="cb432-4"><a href="external-auditors.html#cb432-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-5"><a href="external-auditors.html#cb432-5" aria-hidden="true" tabindex="-1"></a>df_sum <span class="ot">&lt;-</span> revenue <span class="sc">%&gt;%</span> </span>
<span id="cb432-6"><a href="external-auditors.html#cb432-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb432-7"><a href="external-auditors.html#cb432-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(credit, <span class="fu">list</span>(<span class="at">ymin =</span> lb, <span class="at">ymax =</span> ub, <span class="at">mean =</span> mean)))</span>
<span id="cb432-8"><a href="external-auditors.html#cb432-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb432-9"><a href="external-auditors.html#cb432-9" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb432-10"><a href="external-auditors.html#cb432-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">factor</span>(quarter), credit, <span class="at">fill =</span> <span class="fu">factor</span>(quarter))) <span class="sc">+</span></span>
<span id="cb432-11"><a href="external-auditors.html#cb432-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> .<span class="dv">2</span>, <span class="at">y =</span> <span class="dv">0</span>), <span class="at">trim =</span> <span class="cn">TRUE</span>, <span class="at">alpha =</span> .<span class="dv">8</span>, <span class="at">scale =</span> <span class="st">&quot;width&quot;</span>) <span class="sc">+</span></span>
<span id="cb432-12"><a href="external-auditors.html#cb432-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> credit, <span class="at">color =</span> <span class="fu">factor</span>(quarter)), </span>
<span id="cb432-13"><a href="external-auditors.html#cb432-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">width =</span> .<span class="dv">15</span>), <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb432-14"><a href="external-auditors.html#cb432-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> .<span class="dv">1</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb432-15"><a href="external-auditors.html#cb432-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df_sum, <span class="fu">aes</span>(<span class="at">x =</span> quarter, <span class="at">y =</span> credit_mean), </span>
<span id="cb432-16"><a href="external-auditors.html#cb432-16" aria-hidden="true" tabindex="-1"></a>             <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.3</span>), <span class="at">size =</span> <span class="fl">2.5</span>) <span class="sc">+</span></span>
<span id="cb432-17"><a href="external-auditors.html#cb432-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="at">data =</span> df_sum, <span class="fu">aes</span>(<span class="at">ymin =</span> credit_ymin, <span class="at">ymax =</span> credit_ymax, <span class="at">y =</span> credit_mean), </span>
<span id="cb432-18"><a href="external-auditors.html#cb432-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="fu">position_nudge</span>(<span class="at">x =</span> <span class="fl">0.3</span>), <span class="at">width =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb432-19"><a href="external-auditors.html#cb432-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="fl">5.25</span>) <span class="sc">+</span></span>
<span id="cb432-20"><a href="external-auditors.html#cb432-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb432-21"><a href="external-auditors.html#cb432-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> getPalette) <span class="sc">+</span></span>
<span id="cb432-22"><a href="external-auditors.html#cb432-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> getPalette) <span class="sc">+</span></span>
<span id="cb432-23"><a href="external-auditors.html#cb432-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb432-24"><a href="external-auditors.html#cb432-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb432-25"><a href="external-auditors.html#cb432-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="external-auditors.html#cb433-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb433-2"><a href="external-auditors.html#cb433-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(credit, <span class="at">fill =</span> <span class="fu">factor</span>(month))) <span class="sc">+</span></span>
<span id="cb433-3"><a href="external-auditors.html#cb433-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb433-4"><a href="external-auditors.html#cb433-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rug</span>() <span class="sc">+</span></span>
<span id="cb433-5"><a href="external-auditors.html#cb433-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">200</span>, </span>
<span id="cb433-6"><a href="external-auditors.html#cb433-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb433-7"><a href="external-auditors.html#cb433-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb433-8"><a href="external-auditors.html#cb433-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb433-9"><a href="external-auditors.html#cb433-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">name =</span> <span class="st">&quot;&quot;</span>, <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb433-10"><a href="external-auditors.html#cb433-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, </span>
<span id="cb433-11"><a href="external-auditors.html#cb433-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">x =</span> <span class="fu">mean</span>(revenue<span class="sc">$</span>credit) <span class="sc">*</span> <span class="fl">3.6</span>, <span class="at">y =</span> <span class="dv">65</span>,</span>
<span id="cb433-12"><a href="external-auditors.html#cb433-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">&quot;Mean: $&quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(revenue<span class="sc">$</span>credit), <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb433-13"><a href="external-auditors.html#cb433-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span><span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb433-14"><a href="external-auditors.html#cb433-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-180-1.png" width="672" /></p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="external-auditors.html#cb434-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb434-2"><a href="external-auditors.html#cb434-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">fct_relevel</span>(weekday, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb434-3"><a href="external-auditors.html#cb434-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(credit, weekday)) <span class="sc">+</span></span>
<span id="cb434-4"><a href="external-auditors.html#cb434-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb434-5"><a href="external-auditors.html#cb434-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">shape =</span> <span class="dv">16</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.4</span>), <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb434-6"><a href="external-auditors.html#cb434-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">13</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;firebrick&quot;</span>) <span class="sc">+</span></span>
<span id="cb434-7"><a href="external-auditors.html#cb434-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>dollar) <span class="sc">+</span></span>
<span id="cb434-8"><a href="external-auditors.html#cb434-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb434-9"><a href="external-auditors.html#cb434-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="external-auditors.html#cb435-1" aria-hidden="true" tabindex="-1"></a>ml_mth <span class="ot">&lt;-</span> revenue <span class="sc">%&gt;%</span> </span>
<span id="cb435-2"><a href="external-auditors.html#cb435-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday =</span> <span class="fu">fct_relevel</span>(weekday, <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;Mon&quot;</span>, <span class="st">&quot;Tue&quot;</span>, <span class="st">&quot;Wed&quot;</span>, <span class="st">&quot;Thu&quot;</span>, <span class="st">&quot;Fri&quot;</span>, <span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb435-3"><a href="external-auditors.html#cb435-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, weekday) <span class="sc">%&gt;%</span></span>
<span id="cb435-4"><a href="external-auditors.html#cb435-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>(),</span>
<span id="cb435-5"><a href="external-auditors.html#cb435-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">amt =</span> <span class="fu">sum</span>(credit)) <span class="sc">%&gt;%</span> </span>
<span id="cb435-6"><a href="external-auditors.html#cb435-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cum_freq =</span> <span class="fu">cumsum</span>(freq), </span>
<span id="cb435-7"><a href="external-auditors.html#cb435-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">cum_amt =</span> <span class="fu">cumsum</span>(amt)) </span>
<span id="cb435-8"><a href="external-auditors.html#cb435-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb435-9"><a href="external-auditors.html#cb435-9" aria-hidden="true" tabindex="-1"></a>ml_mth <span class="sc">%&gt;%</span> </span>
<span id="cb435-10"><a href="external-auditors.html#cb435-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(amt, freq, <span class="at">color =</span> amt <span class="sc">&gt;</span> <span class="dv">10000</span>)) <span class="sc">+</span></span>
<span id="cb435-11"><a href="external-auditors.html#cb435-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb435-12"><a href="external-auditors.html#cb435-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">10000</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb435-13"><a href="external-auditors.html#cb435-13" aria-hidden="true" tabindex="-1"></a>  ggforce<span class="sc">::</span><span class="fu">geom_mark_ellipse</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(ml_mth, freq <span class="sc">&lt;=</span><span class="dv">10</span>, amt <span class="sc">&gt;=</span> <span class="dv">5000</span>, amt <span class="sc">&lt;=</span> <span class="dv">10000</span>), </span>
<span id="cb435-14"><a href="external-auditors.html#cb435-14" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">aes</span>(<span class="at">description =</span> <span class="st">&quot;Watch closely&quot;</span>), </span>
<span id="cb435-15"><a href="external-auditors.html#cb435-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label.fontsize =</span> <span class="dv">6</span>, </span>
<span id="cb435-16"><a href="external-auditors.html#cb435-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label.buffer =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">&#39;mm&#39;</span>), </span>
<span id="cb435-17"><a href="external-auditors.html#cb435-17" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label.fill =</span> <span class="st">&quot;transparent&quot;</span>, </span>
<span id="cb435-18"><a href="external-auditors.html#cb435-18" aria-hidden="true" tabindex="-1"></a>                             <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb435-19"><a href="external-auditors.html#cb435-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb435-20"><a href="external-auditors.html#cb435-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb435-21"><a href="external-auditors.html#cb435-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">&quot;Exceed&quot;</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>), <span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span>  </span>
<span id="cb435-22"><a href="external-auditors.html#cb435-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Total revenue&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of transactions&quot;</span>) <span class="sc">+</span></span>
<span id="cb435-23"><a href="external-auditors.html#cb435-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-182-1.png" width="672" /></p>
</div>
</div>
<div id="audit-planning" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Audit planning</h2>
<div id="test-of-controls" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Test of controls</h3>
<p>There is no gap on journal entries (JE) numbers.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="external-auditors.html#cb436-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb436-2"><a href="external-auditors.html#cb436-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(num, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb436-3"><a href="external-auditors.html#cb436-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(num) <span class="sc">%&gt;%</span> </span>
<span id="cb436-4"><a href="external-auditors.html#cb436-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gap =</span> <span class="fu">as.numeric</span>(num) <span class="sc">-</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(<span class="fu">as.numeric</span>(num))) <span class="sc">%&gt;%</span> </span>
<span id="cb436-5"><a href="external-auditors.html#cb436-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gap), gap <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>&gt; # A tibble: 0 x 15
&gt; # ... with 15 variables: account &lt;chr&gt;, subaccount &lt;chr&gt;, type &lt;chr&gt;,
&gt; #   date &lt;date&gt;, num &lt;chr&gt;, name &lt;chr&gt;, memo &lt;chr&gt;, split &lt;chr&gt;, debit &lt;dbl&gt;,
&gt; #   credit &lt;dbl&gt;, balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;, quarter &lt;fct&gt;,
&gt; #   gap &lt;dbl&gt;</code></pre>
<p><code>filter</code> out duplicated JE numbers.</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="external-auditors.html#cb438-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb438-2"><a href="external-auditors.html#cb438-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(num, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb438-3"><a href="external-auditors.html#cb438-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>(n)                                                            </span></code></pre></div>
<pre><code>&gt; # A tibble: 94 x 3
&gt;    num       n    nn
&gt;    &lt;chr&gt; &lt;int&gt; &lt;int&gt;
&gt;  1 71072    17     5
&gt;  2 71085    17     5
&gt;  3 71086    17     5
&gt;  4 71087    17     5
&gt;  5 71088    17     5
&gt;  6 71073    15    11
&gt;  7 71074    15    11
&gt;  8 71075    15    11
&gt;  9 71076    15    11
&gt; 10 71077    15    11
&gt; # ... with 84 more rows</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="external-auditors.html#cb440-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb440-2"><a href="external-auditors.html#cb440-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(num) <span class="sc">%&gt;%</span> </span>
<span id="cb440-3"><a href="external-auditors.html#cb440-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">==</span> <span class="dv">17</span>) </span></code></pre></div>
<pre><code>&gt; # A tibble: 85 x 14
&gt; # Groups:   num [5]
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Die Ca~ Acco~     0  367. 
&gt;  2 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Tapest~ Acco~     0  243  
&gt;  3 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Pearl ~ Acco~     0  342  
&gt;  4 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Sunset~ Acco~     0  126  
&gt;  5 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Black ~ Acco~     0  113. 
&gt;  6 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Burnis~ Acco~     0  270  
&gt;  7 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Chestn~ Acco~     0  292. 
&gt;  8 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Pendan~ Acco~     0   22.5
&gt;  9 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Athena~ Acco~     0   81  
&gt; 10 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Cand. ~ Acco~     0   50.4
&gt; # ... with 75 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="external-auditors.html#cb442-1" aria-hidden="true" tabindex="-1"></a>revenue<span class="sc">$</span>num[<span class="fu">duplicated</span>(revenue<span class="sc">$</span>num)] <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code></pre></div>
<pre><code>&gt; [1] &quot;71047&quot; &quot;71047&quot; &quot;71047&quot; &quot;71047&quot; &quot;71047&quot; &quot;71047&quot;</code></pre>
<p><code>filter</code> JE numbers based on columns of date, name, and credit to perform Same same same/different (SSS/SSD) tests.</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="external-auditors.html#cb444-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb444-2"><a href="external-auditors.html#cb444-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(num, date, name, credit) <span class="sc">%&gt;%</span> </span>
<span id="cb444-3"><a href="external-auditors.html#cb444-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb444-4"><a href="external-auditors.html#cb444-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(freq))</span></code></pre></div>
<pre><code>&gt; # A tibble: 817 x 5
&gt; # Groups:   num, date, name [94]
&gt;    num   date       name                                    credit  freq
&gt;    &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;                                    &lt;dbl&gt; &lt;int&gt;
&gt;  1 71123 2018-11-29 Kern Lighting Warehouse:Store #13          0       3
&gt;  2 71052 2018-02-27 Baker&#39;s Professional Lighting:Store #15  210       2
&gt;  3 71064 2018-04-22 Godwin Lighting Depot:Store #404          75.6     2
&gt;  4 71065 2018-03-26 Godwin Lighting Depot:Store #303          75.6     2
&gt;  5 71066 2018-04-28 Godwin Lighting Depot:Store #909          75.6     2
&gt;  6 71068 2018-05-10 Godwin Lighting Depot:Store #909          75.6     2
&gt;  7 71069 2018-05-30 Godwin Lighting Depot:Store #1020         75.6     2
&gt;  8 71070 2018-06-11 Godwin Lighting Depot:Store #303          75.6     2
&gt;  9 71073 2018-08-31 Cole Home Builders:Phase 1 - Lot 5       270       2
&gt; 10 71074 2018-08-24 Cole Home Builders:Phase 1 - Lot 5       270       2
&gt; # ... with 807 more rows</code></pre>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="external-auditors.html#cb446-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb446-2"><a href="external-auditors.html#cb446-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(num <span class="sc">==</span> <span class="st">&quot;71052&quot;</span>, credit <span class="sc">==</span> <span class="dv">210</span>)                            </span></code></pre></div>
<pre><code>&gt; # A tibble: 2 x 14
&gt;   account subaccount type    date       num   name    memo    split debit credit
&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 Revenue Revenue    Invoice 2018-02-27 71052 Baker&#39;~ Polish~ Acco~     0    210
&gt; 2 Revenue Revenue    Invoice 2018-02-27 71052 Baker&#39;~ 2032 S~ Acco~     0    210
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<p>Assume the authority limit is 5000 and <code>filter</code> out those transactions with credit more than the limit.</p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="external-auditors.html#cb448-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span></span>
<span id="cb448-2"><a href="external-auditors.html#cb448-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(credit <span class="sc">&gt;</span> <span class="dv">5000</span>)</span></code></pre></div>
<pre><code>&gt; # A tibble: 12 x 14
&gt;    account subaccount type    date       num   name    memo   split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-29 71124 Kern L~ Burni~ Acco~     0   8400
&gt;  2 Revenue Revenue    Invoice 2018-03-28 71125 Kern L~ Cand.~ Acco~     0   5600
&gt;  3 Revenue Revenue    Invoice 2018-04-13 71126 Kern L~ Golde~ Acco~     0  12600
&gt;  4 Revenue Revenue    Invoice 2018-05-22 71127 Kern L~ Domes~ Acco~     0   6750
&gt;  5 Revenue Revenue    Invoice 2018-07-17 71129 Kern L~ Golde~ Acco~     0   7875
&gt;  6 Revenue Revenue    Invoice 2018-09-25 71107 Stern ~ White~ Acco~     0   5760
&gt;  7 Revenue Revenue    Invoice 2018-09-25 71107 Stern ~ Sunse~ Acco~     0   6300
&gt;  8 Revenue Revenue    Invoice 2018-10-26 71108 Stern ~ Sunse~ Acco~     0   6300
&gt;  9 Revenue Revenue    Invoice 2018-10-26 71108 Stern ~ White~ Acco~     0   5760
&gt; 10 Revenue Revenue    Invoice 2018-12-12 71106 Stern ~ Sunse~ Acco~     0   6300
&gt; 11 Revenue Revenue    Invoice 2018-12-12 71106 Stern ~ Domes~ Acco~     0   8100
&gt; 12 Revenue Revenue    Invoice 2018-12-15 71137 Dan A.~ Custo~ Acco~     0   7000
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
</div>
<div id="digits-tests" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> Digits tests</h3>
<p><code>filter</code> out transaction amount ending with 0.9 or divided by 1000.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="external-auditors.html#cb450-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb450-2"><a href="external-auditors.html#cb450-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">near</span>(credit <span class="sc">-</span> <span class="fu">floor</span>(credit), <span class="fl">0.9</span>))                </span></code></pre></div>
<pre><code>&gt; # A tibble: 10 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-31 71059 Godwi~ Broadw~ Acco~     0  127. 
&gt;  2 Revenue Revenue    Invoice 2018-01-31 71059 Godwi~ Haloge~ Acco~     0    9.9
&gt;  3 Revenue Revenue    Invoice 2018-03-27 71060 Godwi~ Broadw~ Acco~     0  127. 
&gt;  4 Revenue Revenue    Invoice 2018-03-27 71060 Godwi~ Haloge~ Acco~     0    9.9
&gt;  5 Revenue Revenue    Invoice 2018-04-17 71061 Godwi~ Broadw~ Acco~     0  127. 
&gt;  6 Revenue Revenue    Invoice 2018-04-17 71061 Godwi~ Haloge~ Acco~     0    9.9
&gt;  7 Revenue Revenue    Invoice 2018-05-02 71062 Godwi~ Broadw~ Acco~     0  127. 
&gt;  8 Revenue Revenue    Invoice 2018-05-02 71062 Godwi~ Haloge~ Acco~     0    9.9
&gt;  9 Revenue Revenue    Invoice 2018-05-19 71063 Godwi~ Broadw~ Acco~     0  127. 
&gt; 10 Revenue Revenue    Invoice 2018-05-19 71063 Godwi~ Haloge~ Acco~     0    9.9
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="external-auditors.html#cb452-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb452-2"><a href="external-auditors.html#cb452-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(credit <span class="sc">%%</span> <span class="dv">1000</span> <span class="sc">==</span> <span class="dv">0</span>)                              </span></code></pre></div>
<pre><code>&gt; # A tibble: 10 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-03-12 71049 Laver~ Vianne~ Acco~     0   1000
&gt;  2 Revenue Revenue    Invoice 2018-07-13 71119 Kern ~ Burnis~ Acco~     0   3000
&gt;  3 Revenue Revenue    Invoice 2018-08-22 71109 Dan A~ Vianne~ Acco~     0   5000
&gt;  4 Revenue Revenue    Invoice 2018-11-01 71120 Kern ~ Burnis~ Acco~     0   3000
&gt;  5 Revenue Revenue    Invoice 2018-11-29 71123 Kern ~ 18x8x1~ Acco~     0      0
&gt;  6 Revenue Revenue    Invoice 2018-11-29 71123 Kern ~ Burnis~ Acco~     0      0
&gt;  7 Revenue Revenue    Invoice 2018-11-29 71123 Kern ~ Tapest~ Acco~     0      0
&gt;  8 Revenue Revenue    Invoice 2018-12-03 71139 Laver~ Cand. ~ Acco~     0      0
&gt;  9 Revenue Revenue    Invoice 2018-12-15 71137 Dan A~ Custom~ Acco~     0   7000
&gt; 10 Revenue Revenue    Invoice 2018-12-15 71140 Thomp~ Fluore~ Acco~     0      0
&gt; # ... with 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;</code></pre>
<p><code>filter</code> out same amount that appears more than 20 times.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="external-auditors.html#cb454-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb454-2"><a href="external-auditors.html#cb454-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(credit) <span class="sc">%&gt;%</span> </span>
<span id="cb454-3"><a href="external-auditors.html#cb454-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">20</span>)                                         </span></code></pre></div>
<pre><code>&gt; # A tibble: 64 x 14
&gt; # Groups:   credit [3]
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Fluore~ Acco~     0   13.5
&gt;  2 Revenue Revenue    Invoice 2018-01-28 71072 Cole ~ Specia~ Acco~     0   19.8
&gt;  3 Revenue Revenue    Invoice 2018-01-31 71059 Godwi~ Specia~ Acco~     0   19.8
&gt;  4 Revenue Revenue    Invoice 2018-01-31 71059 Godwi~ Fluore~ Acco~     0   13.5
&gt;  5 Revenue Revenue    Invoice 2018-02-12 71088 Cole ~ Fluore~ Acco~     0   13.5
&gt;  6 Revenue Revenue    Invoice 2018-02-12 71088 Cole ~ Specia~ Acco~     0   19.8
&gt;  7 Revenue Revenue    Invoice 2018-03-26 71065 Godwi~ Drop O~ Acco~     0   75.6
&gt;  8 Revenue Revenue    Invoice 2018-03-26 71065 Godwi~ Cand. ~ Acco~     0   75.6
&gt;  9 Revenue Revenue    Invoice 2018-03-26 71065 Godwi~ Fluore~ Acco~     0   13.5
&gt; 10 Revenue Revenue    Invoice 2018-03-26 71065 Godwi~ Specia~ Acco~     0   19.8
&gt; # ... with 54 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="external-auditors.html#cb456-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb456-2"><a href="external-auditors.html#cb456-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(credit <span class="sc">&gt;</span> <span class="dv">5000</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb456-3"><a href="external-auditors.html#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(credit), tibble<span class="sc">::</span><span class="fu">lst</span>(min, max, mean, median, sum)))</span></code></pre></div>
<pre><code>&gt; # A tibble: 2 x 6
&gt;   `credit &gt; 5000` credit_min credit_max credit_mean credit_median credit_sum
&gt; * &lt;lgl&gt;                &lt;dbl&gt;      &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
&gt; 1 FALSE                    0       5000        389.           168    325065.
&gt; 2 TRUE                  5600      12600       7229.          6525     86745</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="external-auditors.html#cb458-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb458-2"><a href="external-auditors.html#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">credit_new =</span> <span class="dv">2000</span> <span class="sc">*</span>(credit <span class="sc">%/%</span> <span class="dv">2000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb458-3"><a href="external-auditors.html#cb458-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">total =</span> <span class="fu">sum</span>(credit))</span></code></pre></div>
<pre><code>&gt; # A tibble: 6 x 3
&gt;   credit_new     n   total
&gt; *      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
&gt; 1          0   801 221168.
&gt; 2       2000    28  76646.
&gt; 3       4000     9  44370 
&gt; 4       6000     6  40525 
&gt; 5       8000     2  16500 
&gt; 6      12000     1  12600</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="external-auditors.html#cb460-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span></span>
<span id="cb460-2"><a href="external-auditors.html#cb460-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(<span class="at">cut_amt =</span> <span class="fu">cut</span>(credit, </span>
<span id="cb460-3"><a href="external-auditors.html#cb460-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">20000</span>, <span class="fu">max</span>(credit)),</span>
<span id="cb460-4"><a href="external-auditors.html#cb460-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;ML&quot;</span>,<span class="st">&quot;1K&quot;</span>,<span class="st">&quot;5K&quot;</span>,<span class="st">&quot;10K&quot;</span>, <span class="st">&quot;Outlier&quot;</span>))) </span></code></pre></div>
<pre><code>&gt; # A tibble: 4 x 2
&gt;   cut_amt     n
&gt; * &lt;fct&gt;   &lt;int&gt;
&gt; 1 ML        765
&gt; 2 1K         70
&gt; 3 5K         11
&gt; 4 10K         1</code></pre>
</div>
<div id="benfords-law" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> Benford’s law</h3>
<p>The result conforms to Benford’s law based on frequency.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="external-auditors.html#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(benford.analysis)</span>
<span id="cb462-2"><a href="external-auditors.html#cb462-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-3"><a href="external-auditors.html#cb462-3" aria-hidden="true" tabindex="-1"></a>bfd.cp <span class="ot">&lt;-</span> <span class="fu">benford</span>(revenue<span class="sc">$</span>credit, <span class="at">number.of.digits =</span> <span class="dv">2</span>, <span class="at">sign =</span> <span class="st">&quot;both&quot;</span>, <span class="at">round =</span> <span class="dv">3</span>) </span>
<span id="cb462-4"><a href="external-auditors.html#cb462-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bfd.cp) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="external-auditors.html#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getSuspects</span>(bfd.cp, revenue, <span class="at">by =</span> <span class="st">&quot;absolute.diff&quot;</span>, <span class="at">how.many =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">as_tibble</span>()</span></code></pre></div>
<pre><code>&gt; # A tibble: 29 x 14
&gt;    account subaccount type    date       num   name    memo   split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-03-26 71065 Godwin~ Drop ~ Acco~     0   75.6
&gt;  2 Revenue Revenue    Invoice 2018-03-26 71065 Godwin~ Cand.~ Acco~     0   75.6
&gt;  3 Revenue Revenue    Invoice 2018-04-22 71064 Godwin~ Drop ~ Acco~     0   75.6
&gt;  4 Revenue Revenue    Invoice 2018-04-22 71064 Godwin~ Cand.~ Acco~     0   75.6
&gt;  5 Revenue Revenue    Invoice 2018-04-28 71066 Godwin~ Drop ~ Acco~     0   75.6
&gt;  6 Revenue Revenue    Invoice 2018-04-28 71066 Godwin~ Cand.~ Acco~     0   75.6
&gt;  7 Revenue Revenue    Invoice 2018-04-28 71067 Dan A.~ Fluor~ Acco~     0   75  
&gt;  8 Revenue Revenue    Invoice 2018-05-10 71068 Godwin~ Drop ~ Acco~     0   75.6
&gt;  9 Revenue Revenue    Invoice 2018-05-10 71068 Godwin~ Cand.~ Acco~     0   75.6
&gt; 10 Revenue Revenue    Invoice 2018-05-16 71095 Miscel~ Penda~ Acco~     0   75  
&gt; # ... with 19 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="external-auditors.html#cb465-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb465-2"><a href="external-auditors.html#cb465-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(credit <span class="sc">&gt;=</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb465-3"><a href="external-auditors.html#cb465-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(credit) <span class="sc">%&gt;%</span> </span>
<span id="cb465-4"><a href="external-auditors.html#cb465-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb465-5"><a href="external-auditors.html#cb465-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(freq)) <span class="sc">%&gt;%</span> </span>
<span id="cb465-6"><a href="external-auditors.html#cb465-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">first_two =</span> <span class="fu">sapply</span>(credit, <span class="cf">function</span>(x) <span class="fu">substring</span>(x, <span class="at">first =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">last =</span> <span class="fu">c</span>(<span class="dv">2</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb465-7"><a href="external-auditors.html#cb465-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(first_two, <span class="at">sort =</span> <span class="cn">TRUE</span>)                                 </span></code></pre></div>
<pre><code>&gt; # A tibble: 78 x 2
&gt;    first_two     n
&gt;    &lt;chr&gt;     &lt;int&gt;
&gt;  1 12           12
&gt;  2 13            9
&gt;  3 11            7
&gt;  4 18            7
&gt;  5 19            7
&gt;  6 10            6
&gt;  7 21            6
&gt;  8 22            6
&gt;  9 28            6
&gt; 10 14            5
&gt; # ... with 68 more rows</code></pre>
</div>
<div id="outlier" class="section level3" number="5.4.4">
<h3><span class="header-section-number">5.4.4</span> Outlier</h3>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="external-auditors.html#cb467-1" aria-hidden="true" tabindex="-1"></a>revenue[<span class="fu">which</span>(revenue<span class="sc">$</span>credit <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">boxplot.stats</span>(revenue<span class="sc">$</span>credit)<span class="sc">$</span>out)), ]</span></code></pre></div>
<pre><code>&gt; # A tibble: 105 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Pearl ~ Acco~     0   2375
&gt;  2 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Roman ~ Acco~     0    850
&gt;  3 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Tiffan~ Acco~     0   1020
&gt;  4 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ River ~ Acco~     0   1800
&gt;  5 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0   8400
&gt;  6 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ 18x8x1~ Acco~     0   1320
&gt;  7 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ 18x8x1~ Acco~     0   1980
&gt;  8 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ Solid ~ Acco~     0   1260
&gt;  9 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ White,~ Acco~     0    960
&gt; 10 Revenue Revenue    Invoice 2018-02-10 71051 Cole ~ Golden~ Acco~     0   1890
&gt; # ... with 95 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="external-auditors.html#cb469-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(revenue, revenue<span class="sc">$</span>credit <span class="sc">%in%</span> <span class="fu">boxplot</span>(revenue<span class="sc">$</span>credit <span class="sc">~</span> revenue<span class="sc">$</span>month)<span class="sc">$</span>out) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-196-1.png" width="672" /></p>
<pre><code>&gt; # A tibble: 96 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Pearl ~ Acco~     0   2375
&gt;  2 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Roman ~ Acco~     0    850
&gt;  3 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Tiffan~ Acco~     0   1020
&gt;  4 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ River ~ Acco~     0   1800
&gt;  5 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0   8400
&gt;  6 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ 18x8x1~ Acco~     0   1320
&gt;  7 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ 18x8x1~ Acco~     0   1980
&gt;  8 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ Solid ~ Acco~     0   1260
&gt;  9 Revenue Revenue    Invoice 2018-02-01 71121 Kern ~ White,~ Acco~     0    960
&gt; 10 Revenue Revenue    Invoice 2018-02-10 71051 Cole ~ Golden~ Acco~     0   1890
&gt; # ... with 86 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="external-auditors.html#cb471-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(credit <span class="sc">&gt;</span> <span class="fu">quantile</span>(credit, <span class="at">prob =</span> .<span class="dv">95</span>))</span></code></pre></div>
<pre><code>&gt; # A tibble: 41 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Pearl ~ Acco~     0   2375
&gt;  2 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0   8400
&gt;  3 Revenue Revenue    Invoice 2018-03-28 71071 Dan A~ Domes,~ Acco~     0   4500
&gt;  4 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Vianne~ Acco~     0   2900
&gt;  5 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Cand. ~ Acco~     0   5600
&gt;  6 Revenue Revenue    Invoice 2018-04-13 71126 Kern ~ Golden~ Acco~     0  12600
&gt;  7 Revenue Revenue    Invoice 2018-04-28 71067 Dan A~ Bevele~ Acco~     0   2400
&gt;  8 Revenue Revenue    Invoice 2018-04-28 71067 Dan A~ Flush ~ Acco~     0   2975
&gt;  9 Revenue Revenue    Invoice 2018-05-22 71127 Kern ~ Domes,~ Acco~     0   6750
&gt; 10 Revenue Revenue    Invoice 2018-06-10 71128 Kern ~ Fluore~ Acco~     0   4500
&gt; # ... with 31 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="external-auditors.html#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(revenue, </span>
<span id="cb473-2"><a href="external-auditors.html#cb473-2" aria-hidden="true" tabindex="-1"></a>       revenue<span class="sc">$</span>credit <span class="sc">&gt;</span> (<span class="fu">quantile</span>(revenue<span class="sc">$</span>credit, .<span class="dv">25</span>) <span class="sc">-</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(revenue<span class="sc">$</span>credit)) <span class="sc">&amp;</span> </span>
<span id="cb473-3"><a href="external-auditors.html#cb473-3" aria-hidden="true" tabindex="-1"></a>       revenue<span class="sc">$</span>credit <span class="sc">&lt;</span> (<span class="fu">quantile</span>(revenue<span class="sc">$</span>credit, .<span class="dv">75</span>) <span class="sc">+</span> <span class="fl">1.5</span><span class="sc">*</span><span class="fu">IQR</span>(revenue<span class="sc">$</span>credit)))</span></code></pre></div>
<pre><code>&gt; # A tibble: 742 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Pearl ~ Acco~     0    570
&gt;  2 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Black ~ Acco~     0     84
&gt;  3 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Bevele~ Acco~     0    144
&gt;  4 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Tiffan~ Acco~     0    510
&gt;  5 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Burnis~ Acco~     0    600
&gt;  6 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Specia~ Acco~     0     55
&gt;  7 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Pendan~ Acco~     0     50
&gt;  8 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Verona~ Acco~     0    300
&gt;  9 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Haloge~ Acco~     0     12
&gt; 10 Revenue Revenue    Invoice 2018-01-06 71047 Baker~ Cand. ~ Acco~     0     56
&gt; # ... with 732 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="external-auditors.html#cb475-1" aria-hidden="true" tabindex="-1"></a>revenue[<span class="fu">which</span>(<span class="fu">ecdf</span>(revenue<span class="sc">$</span>credit)(revenue<span class="sc">$</span>credit) <span class="sc">&gt;</span> <span class="fl">0.95</span>), ]                       </span></code></pre></div>
<pre><code>&gt; # A tibble: 44 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-14 71050 Godwi~ Pearl ~ Acco~     0   2375
&gt;  2 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0   8400
&gt;  3 Revenue Revenue    Invoice 2018-03-28 71071 Dan A~ Domes,~ Acco~     0   4500
&gt;  4 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Vianne~ Acco~     0   2900
&gt;  5 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Cand. ~ Acco~     0   5600
&gt;  6 Revenue Revenue    Invoice 2018-04-13 71126 Kern ~ Golden~ Acco~     0  12600
&gt;  7 Revenue Revenue    Invoice 2018-04-28 71067 Dan A~ Coloni~ Acco~     0   2100
&gt;  8 Revenue Revenue    Invoice 2018-04-28 71067 Dan A~ Bevele~ Acco~     0   2400
&gt;  9 Revenue Revenue    Invoice 2018-04-28 71067 Dan A~ Flush ~ Acco~     0   2975
&gt; 10 Revenue Revenue    Invoice 2018-05-22 71127 Kern ~ Domes,~ Acco~     0   6750
&gt; # ... with 34 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="external-auditors.html#cb477-1" aria-hidden="true" tabindex="-1"></a>revenue[<span class="fu">which</span>(<span class="fu">abs</span>(<span class="fu">scale</span>(revenue<span class="sc">$</span>credit)) <span class="sc">&gt;</span> <span class="fl">1.96</span>), ]                                 </span></code></pre></div>
<pre><code>&gt; # A tibble: 33 x 14
&gt;    account subaccount type    date       num   name   memo    split debit credit
&gt;    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Revenue Revenue    Invoice 2018-01-29 71124 Kern ~ Burnis~ Acco~     0   8400
&gt;  2 Revenue Revenue    Invoice 2018-03-28 71071 Dan A~ Domes,~ Acco~     0   4500
&gt;  3 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Vianne~ Acco~     0   2900
&gt;  4 Revenue Revenue    Invoice 2018-03-28 71125 Kern ~ Cand. ~ Acco~     0   5600
&gt;  5 Revenue Revenue    Invoice 2018-04-13 71126 Kern ~ Golden~ Acco~     0  12600
&gt;  6 Revenue Revenue    Invoice 2018-04-28 71067 Dan A~ Flush ~ Acco~     0   2975
&gt;  7 Revenue Revenue    Invoice 2018-05-22 71127 Kern ~ Domes,~ Acco~     0   6750
&gt;  8 Revenue Revenue    Invoice 2018-06-10 71128 Kern ~ Fluore~ Acco~     0   4500
&gt;  9 Revenue Revenue    Invoice 2018-07-13 71119 Kern ~ Golden~ Acco~     0   3150
&gt; 10 Revenue Revenue    Invoice 2018-07-13 71119 Kern ~ Burnis~ Acco~     0   3000
&gt; # ... with 23 more rows, and 4 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;,
&gt; #   month &lt;ord&gt;, quarter &lt;fct&gt;</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="external-auditors.html#cb479-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb479-2"><a href="external-auditors.html#cb479-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">z_score =</span> <span class="fu">scale</span>(credit), </span>
<span id="cb479-3"><a href="external-auditors.html#cb479-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">z_label =</span> <span class="fu">ifelse</span>(<span class="fu">abs</span>(z_score <span class="sc">-</span> <span class="fu">mean</span>(z_score)) <span class="sc">&gt;</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sd</span>(z_score), <span class="st">&quot;z&quot;</span>, <span class="st">&quot;ok&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb479-4"><a href="external-auditors.html#cb479-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(z_label <span class="sc">==</span> <span class="st">&quot;z&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb479-5"><a href="external-auditors.html#cb479-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb479-6"><a href="external-auditors.html#cb479-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(credit, month, <span class="at">size =</span> credit <span class="sc">&gt;</span> <span class="dv">6000</span>), <span class="at">alpha =</span> .<span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb479-7"><a href="external-auditors.html#cb479-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(credit, month, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb479-8"><a href="external-auditors.html#cb479-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">6000</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb479-9"><a href="external-auditors.html#cb479-9" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="at">data =</span> <span class="fu">subset</span>(revenue, credit <span class="sc">&gt;</span> <span class="dv">6000</span>),</span>
<span id="cb479-10"><a href="external-auditors.html#cb479-10" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(credit, month, <span class="at">label =</span> name), </span>
<span id="cb479-11"><a href="external-auditors.html#cb479-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>,</span>
<span id="cb479-12"><a href="external-auditors.html#cb479-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb479-13"><a href="external-auditors.html#cb479-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb479-14"><a href="external-auditors.html#cb479-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>), <span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb479-15"><a href="external-auditors.html#cb479-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">guide =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb479-16"><a href="external-auditors.html#cb479-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x =</span> <span class="dv">6200</span>, <span class="at">y =</span> <span class="dv">6</span>, <span class="at">label =</span> <span class="st">&quot;6,000&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb479-17"><a href="external-auditors.html#cb479-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb479-18"><a href="external-auditors.html#cb479-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb479-19"><a href="external-auditors.html#cb479-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Identification of sales outlier based on Z-score&quot;</span>,</span>
<span id="cb479-20"><a href="external-auditors.html#cb479-20" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-200-1.png" width="672" /></p>
</div>
<div id="ratios" class="section level3" number="5.4.5">
<h3><span class="header-section-number">5.4.5</span> Ratios</h3>
<p>Remove any rows containing 0 in monthly financial statements, and then perform horizontal and vertical ratio analysis. The final result is present in a formatted table.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="external-auditors.html#cb480-1" aria-hidden="true" tabindex="-1"></a>mth_fs[<span class="fu">apply</span>(mth_fs[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">all</span>(x <span class="sc">!=</span> <span class="dv">0</span>)), ] </span></code></pre></div>
<pre><code>&gt; # A tibble: 30 x 14
&gt;    account    subaccount        Jan     Feb     Mar     Apr    May    Jun    Jul
&gt;    &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Accounts ~ Accounts Pay~ -3.59e4 -45421  -21732. -23299  -3916. -6852. -4067.
&gt;  2 Accounts ~ Accounts Rec~  2.24e4  10455.  16399.  16583. 21162. 26078. 38024.
&gt;  3 Accumulat~ Accumulated ~ -7.69e1   -154.   -231.   -308.  -385.  -462.  -538.
&gt;  4 Car/Truck~ Car Lease      5.63e2   1126    1689    2252   2815   3378   3941 
&gt;  5 Car/Truck~ Insurance-Au~  1.2 e2    240     360     480    600    720    840 
&gt;  6 Company C~ Company Chec~  2.14e4  25957.  44125.   7784. 35514. 76992. 42187.
&gt;  7 Deborah W~ Deborah Wood~  1.05e4  22750   32750   44500  56500  67750  77750 
&gt;  8 Depreciat~ Depreciation~  7.69e1    154.    231.    308.   385.   462.   538.
&gt;  9 Direct La~ Wages - Ware~  8.1 e2   2430    4050    5670   7290   8910  10530 
&gt; 10 Insurance  General Liab~  2.3 e2    460     690     920   1150   1380   1610 
&gt; # ... with 20 more rows, and 5 more variables: Aug &lt;dbl&gt;, Sep &lt;dbl&gt;, Oct &lt;dbl&gt;,
&gt; #   Nov &lt;dbl&gt;, Dec &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="external-auditors.html#cb482-1" aria-hidden="true" tabindex="-1"></a>mth_fs <span class="sc">%&gt;%</span> </span>
<span id="cb482-2"><a href="external-auditors.html#cb482-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb482-3"><a href="external-auditors.html#cb482-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">all</span>(<span class="fu">c_across</span>(<span class="sc">-</span><span class="fu">c</span>(account, subaccount)) <span class="sc">!=</span> <span class="dv">0</span>))</span></code></pre></div>
<pre><code>&gt; # A tibble: 30 x 14
&gt; # Rowwise: 
&gt;    account    subaccount        Jan     Feb     Mar     Apr    May    Jun    Jul
&gt;    &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
&gt;  1 Accounts ~ Accounts Pay~ -3.59e4 -45421  -21732. -23299  -3916. -6852. -4067.
&gt;  2 Accounts ~ Accounts Rec~  2.24e4  10455.  16399.  16583. 21162. 26078. 38024.
&gt;  3 Accumulat~ Accumulated ~ -7.69e1   -154.   -231.   -308.  -385.  -462.  -538.
&gt;  4 Car/Truck~ Car Lease      5.63e2   1126    1689    2252   2815   3378   3941 
&gt;  5 Car/Truck~ Insurance-Au~  1.2 e2    240     360     480    600    720    840 
&gt;  6 Company C~ Company Chec~  2.14e4  25957.  44125.   7784. 35514. 76992. 42187.
&gt;  7 Deborah W~ Deborah Wood~  1.05e4  22750   32750   44500  56500  67750  77750 
&gt;  8 Depreciat~ Depreciation~  7.69e1    154.    231.    308.   385.   462.   538.
&gt;  9 Direct La~ Wages - Ware~  8.1 e2   2430    4050    5670   7290   8910  10530 
&gt; 10 Insurance  General Liab~  2.3 e2    460     690     920   1150   1380   1610 
&gt; # ... with 20 more rows, and 5 more variables: Aug &lt;dbl&gt;, Sep &lt;dbl&gt;, Oct &lt;dbl&gt;,
&gt; #   Nov &lt;dbl&gt;, Dec &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="external-auditors.html#cb484-1" aria-hidden="true" tabindex="-1"></a>mth_fs_0 <span class="ot">&lt;-</span> mth_fs <span class="sc">%&gt;%</span> </span>
<span id="cb484-2"><a href="external-auditors.html#cb484-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>account) <span class="sc">%&gt;%</span> </span>
<span id="cb484-3"><a href="external-auditors.html#cb484-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb484-4"><a href="external-auditors.html#cb484-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">all</span>(<span class="fu">c_across</span>(<span class="sc">-</span><span class="fu">c</span>(subaccount)) <span class="sc">!=</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb484-5"><a href="external-auditors.html#cb484-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_to_rownames</span>(<span class="st">&#39;subaccount&#39;</span>) </span>
<span id="cb484-6"><a href="external-auditors.html#cb484-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-7"><a href="external-auditors.html#cb484-7" aria-hidden="true" tabindex="-1"></a>cogs_sales <span class="ot">&lt;-</span> mth_fs_0[<span class="st">&quot;Purchases  (Cost of Goods)&quot;</span>, ] <span class="sc">/</span> <span class="fu">abs</span>(mth_fs_0[<span class="st">&#39;Revenue&#39;</span>, ])</span>
<span id="cb484-8"><a href="external-auditors.html#cb484-8" aria-hidden="true" tabindex="-1"></a>inventory_cogs <span class="ot">&lt;-</span> mth_fs_0[<span class="st">&quot;Purchases  (Cost of Goods)&quot;</span>, ] <span class="sc">/</span> mth_fs_0[<span class="st">&#39;Inventory Asset&#39;</span>, ]</span>
<span id="cb484-9"><a href="external-auditors.html#cb484-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-10"><a href="external-auditors.html#cb484-10" aria-hidden="true" tabindex="-1"></a>mth_fs_0_ratio <span class="ot">&lt;-</span> mth_fs_0 <span class="sc">%&gt;%</span> </span>
<span id="cb484-11"><a href="external-auditors.html#cb484-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(cogs_sales) <span class="sc">%&gt;%</span> </span>
<span id="cb484-12"><a href="external-auditors.html#cb484-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_row</span>(inventory_cogs) <span class="sc">%&gt;%</span> </span>
<span id="cb484-13"><a href="external-auditors.html#cb484-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Subaccount&quot;</span>)                                     </span>
<span id="cb484-14"><a href="external-auditors.html#cb484-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb484-15"><a href="external-auditors.html#cb484-15" aria-hidden="true" tabindex="-1"></a>mth_fs_0_ratio[<span class="dv">31</span>, <span class="st">&quot;Subaccount&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;COGS/Sales&quot;</span></span>
<span id="cb484-16"><a href="external-auditors.html#cb484-16" aria-hidden="true" tabindex="-1"></a>mth_fs_0_ratio[<span class="dv">32</span>, <span class="st">&quot;Subaccount&quot;</span>] <span class="ot">&lt;-</span> <span class="st">&quot;COGS/Inventory&quot;</span></span></code></pre></div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="external-auditors.html#cb485-1" aria-hidden="true" tabindex="-1"></a>report_tbl <span class="ot">&lt;-</span> mth_fs_0_ratio <span class="sc">%&gt;%</span></span>
<span id="cb485-2"><a href="external-auditors.html#cb485-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(</span>
<span id="cb485-3"><a href="external-auditors.html#cb485-3" aria-hidden="true" tabindex="-1"></a>    Subaccount <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Revenue&quot;</span>, <span class="st">&quot;Purchases  (Cost of Goods)&quot;</span>, <span class="st">&quot;Inventory Asset&quot;</span>, <span class="st">&quot;COGS/Sales&quot;</span>, <span class="st">&quot;COGS/Inventory&quot;</span>)</span>
<span id="cb485-4"><a href="external-auditors.html#cb485-4" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb485-5"><a href="external-auditors.html#cb485-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb485-6"><a href="external-auditors.html#cb485-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Jan_Feb =</span> (Feb <span class="sc">-</span> Jan)<span class="sc">/</span>Jan, </span>
<span id="cb485-7"><a href="external-auditors.html#cb485-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Feb_Mar =</span> (Mar <span class="sc">-</span> Feb)<span class="sc">/</span>Feb, </span>
<span id="cb485-8"><a href="external-auditors.html#cb485-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Mar_Apr =</span> (Apr <span class="sc">-</span> Mar)<span class="sc">/</span>Mar, </span>
<span id="cb485-9"><a href="external-auditors.html#cb485-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Apr_May =</span> (May <span class="sc">-</span> Apr)<span class="sc">/</span>Apr, </span>
<span id="cb485-10"><a href="external-auditors.html#cb485-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">May_Jun =</span> (Jun <span class="sc">-</span> May)<span class="sc">/</span>May, </span>
<span id="cb485-11"><a href="external-auditors.html#cb485-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">Jun_Jul =</span> (Jul <span class="sc">-</span> Jun)<span class="sc">/</span>Jun, </span>
<span id="cb485-12"><a href="external-auditors.html#cb485-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">Jul_Aug =</span> (Aug <span class="sc">-</span> Jul)<span class="sc">/</span>Jul, </span>
<span id="cb485-13"><a href="external-auditors.html#cb485-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">Aug_Sep =</span> (Sep <span class="sc">-</span> Aug)<span class="sc">/</span>Aug, </span>
<span id="cb485-14"><a href="external-auditors.html#cb485-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sep_Oct =</span> (Oct <span class="sc">-</span> Sep)<span class="sc">/</span>Sep, </span>
<span id="cb485-15"><a href="external-auditors.html#cb485-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Oct_Nov =</span> (Nov <span class="sc">-</span> Oct)<span class="sc">/</span>Oct, </span>
<span id="cb485-16"><a href="external-auditors.html#cb485-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Nov_Dec =</span> (Dec <span class="sc">-</span> Nov)<span class="sc">/</span>Nov</span>
<span id="cb485-17"><a href="external-auditors.html#cb485-17" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb485-18"><a href="external-auditors.html#cb485-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(Jan<span class="sc">:</span>Dec)) <span class="sc">%&gt;%</span> </span>
<span id="cb485-19"><a href="external-auditors.html#cb485-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(Subaccount), <span class="sc">~</span>formattable<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(<span class="fu">abs</span>(.x), <span class="dv">2</span>)))) </span>
<span id="cb485-20"><a href="external-auditors.html#cb485-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb485-21"><a href="external-auditors.html#cb485-21" aria-hidden="true" tabindex="-1"></a>report_tbl <span class="sc">%&gt;%</span>                                                                  </span>
<span id="cb485-22"><a href="external-auditors.html#cb485-22" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Horizontal and Vertical Analysis&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb485-23"><a href="external-auditors.html#cb485-23" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable_paper</span>(<span class="st">&quot;hover&quot;</span>, <span class="at">full_width =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb485-24"><a href="external-auditors.html#cb485-24" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;Financial Year ended as at 31/12/2018&quot;</span> <span class="ot">=</span> <span class="dv">12</span>), </span>
<span id="cb485-25"><a href="external-auditors.html#cb485-25" aria-hidden="true" tabindex="-1"></a>                               <span class="at">background =</span> <span class="st">&quot;teal&quot;</span>, </span>
<span id="cb485-26"><a href="external-auditors.html#cb485-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb485-27"><a href="external-auditors.html#cb485-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">bold =</span> <span class="cn">TRUE</span>, </span>
<span id="cb485-28"><a href="external-auditors.html#cb485-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">align =</span> <span class="st">&quot;left&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb485-29"><a href="external-auditors.html#cb485-29" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">row_spec</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">background =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb485-30"><a href="external-auditors.html#cb485-30" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">column_spec</span>(<span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb485-31"><a href="external-auditors.html#cb485-31" aria-hidden="true" tabindex="-1"></a>                          <span class="at">background =</span> <span class="st">&quot;pink&quot;</span>) <span class="sc">%&gt;%</span>                                         </span>
<span id="cb485-32"><a href="external-auditors.html#cb485-32" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">footnote</span>(<span class="at">symbol =</span> <span class="fu">c</span>(<span class="st">&quot;COGS and Revenue decrease over the period; &quot;</span>, </span>
<span id="cb485-33"><a href="external-auditors.html#cb485-33" aria-hidden="true" tabindex="-1"></a>                                  <span class="st">&quot;COGS/Inventory decrease over the period; &quot;</span>),</span>
<span id="cb485-34"><a href="external-auditors.html#cb485-34" aria-hidden="true" tabindex="-1"></a>                       <span class="at">footnote_as_chunk =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="external-auditors.html#cb486-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/ratio_tbl.png&quot;</span>)</span></code></pre></div>
<p><img src="img/ratio_tbl.png" width="960" /></p>
</div>
<div id="cutomers" class="section level3" number="5.4.6">
<h3><span class="header-section-number">5.4.6</span> Cutomers</h3>
<p>Identify Top 10 customers based on total sales amount.</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="external-auditors.html#cb487-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span></span>
<span id="cb487-2"><a href="external-auditors.html#cb487-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(name, <span class="at">wt =</span> credit, <span class="at">sort =</span> <span class="cn">TRUE</span>) </span></code></pre></div>
<pre><code>&gt; # A tibble: 54 x 2
&gt;    name                                                 n
&gt;    &lt;chr&gt;                                            &lt;dbl&gt;
&gt;  1 Kern Lighting Warehouse:Store #13               37725 
&gt;  2 Kern Lighting Warehouse:Store #01               34929 
&gt;  3 Kern Lighting Warehouse:Store #34               34625.
&gt;  4 Kern Lighting Warehouse:Store #45               30675 
&gt;  5 Cole Home Builders:Phase 1 - Lot 5              25877.
&gt;  6 Stern Commercial Contractor&#39;s:Walker Properties 21330 
&gt;  7 Stern Commercial Contractor&#39;s:Tittle Properties 17433 
&gt;  8 Thompson Lighting Stores:Store #15              14825 
&gt;  9 Stern Commercial Contractor&#39;s:Wilson Suites     14355 
&gt; 10 Cole Home Builders:Phase 2 - Lot 5              13973.
&gt; # ... with 44 more rows</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="external-auditors.html#cb489-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb489-2"><a href="external-auditors.html#cb489-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">fct_lump</span>(name, <span class="dv">10</span>, <span class="at">w =</span> credit), </span>
<span id="cb489-3"><a href="external-auditors.html#cb489-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="fu">fct_reorder</span>(name, credit, sum)) <span class="sc">%&gt;%</span>                       </span>
<span id="cb489-4"><a href="external-auditors.html#cb489-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(credit, name)) <span class="sc">+</span> </span>
<span id="cb489-5"><a href="external-auditors.html#cb489-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb489-6"><a href="external-auditors.html#cb489-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">label =</span> scales<span class="sc">::</span>comma) <span class="sc">+</span></span>
<span id="cb489-7"><a href="external-auditors.html#cb489-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>) <span class="sc">+</span></span>
<span id="cb489-8"><a href="external-auditors.html#cb489-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-206-1.png" width="672" /></p>
<p><code>summarize</code> a table for customers, which includes how much they purchased on weekends.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="external-auditors.html#cb490-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb490-2"><a href="external-auditors.html#cb490-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb490-3"><a href="external-auditors.html#cb490-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb490-4"><a href="external-auditors.html#cb490-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb490-5"><a href="external-auditors.html#cb490-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">across</span>(credit, tibble<span class="sc">::</span><span class="fu">lst</span>(sum, sd, mean, median, min, max, first, last)), </span>
<span id="cb490-6"><a href="external-auditors.html#cb490-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">weekend_n =</span> <span class="fu">length</span>(credit[weekday <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>)]), </span>
<span id="cb490-7"><a href="external-auditors.html#cb490-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">weekend_sum =</span> <span class="fu">sum</span>(credit[weekday <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Sat&quot;</span>, <span class="st">&quot;Sun&quot;</span>)]), </span>
<span id="cb490-8"><a href="external-auditors.html#cb490-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) </span></code></pre></div>
<pre><code>&gt; # A tibble: 54 x 12
&gt;    name              n credit_sum credit_sd credit_mean credit_median credit_min
&gt;    &lt;chr&gt;         &lt;int&gt;      &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;      &lt;dbl&gt;
&gt;  1 Baker&#39;s Prof~     7      2391      284.         342.         232        50   
&gt;  2 Baker&#39;s Prof~    13     12718.    1175.         978.         582        22   
&gt;  3 Baker&#39;s Prof~    17      3307      155.         195.         210         9   
&gt;  4 Baker&#39;s Prof~     8      1872      249.         234          129        11   
&gt;  5 Baker&#39;s Prof~    10      2381      237.         238.         114        12   
&gt;  6 Cole Home Bu~    17      2187.     124.         129.          86.4       4.95
&gt;  7 Cole Home Bu~    17      2187.     124.         129.          86.4       4.95
&gt;  8 Cole Home Bu~   196     25877.      96.0        132.         104.        4.95
&gt;  9 Cole Home Bu~    81     13973.     250.         173.         112         4.95
&gt; 10 Dan A. North~     1      7000       NA         7000         7000      7000   
&gt; # ... with 44 more rows, and 5 more variables: credit_max &lt;dbl&gt;,
&gt; #   credit_first &lt;dbl&gt;, credit_last &lt;dbl&gt;, weekend_n &lt;int&gt;, weekend_sum &lt;dbl&gt;</code></pre>
<p>Relative size factor (RSF) compares the biggest sales to the second biggest sales.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="external-auditors.html#cb492-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb492-2"><a href="external-auditors.html#cb492-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb492-3"><a href="external-auditors.html#cb492-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(credit)) <span class="sc">%&gt;%</span> </span>
<span id="cb492-4"><a href="external-auditors.html#cb492-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb492-5"><a href="external-auditors.html#cb492-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rsf =</span> <span class="fu">round</span>(credit <span class="sc">/</span> dplyr<span class="sc">::</span><span class="fu">lag</span>(credit), <span class="at">digits =</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span>       </span>
<span id="cb492-6"><a href="external-auditors.html#cb492-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(rsf <span class="sc">&lt;</span> <span class="fl">0.5</span>) </span></code></pre></div>
<pre><code>&gt; # A tibble: 6 x 15
&gt; # Groups:   name [6]
&gt;   account subaccount type    date       num   name    memo    split debit credit
&gt;   &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;date&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;
&gt; 1 Revenue Revenue    Invoice 2018-03-28 71071 Dan A.~ Flat G~ Acco~     0   1875
&gt; 2 Revenue Revenue    Invoice 2018-11-01 71120 Kern L~ 18x8x1~ Acco~     0   3300
&gt; 3 Revenue Revenue    Invoice 2018-02-28 71122 Lavery~ Custom~ Acco~     0    600
&gt; 4 Revenue Revenue    Invoice 2018-09-25 71100 Miscel~ Verona~ Acco~     0    600
&gt; 5 Revenue Revenue    Invoice 2018-12-10 71105 Miscel~ Chestn~ Acco~     0    325
&gt; 6 Revenue Revenue    Invoice 2018-04-10 71057 Miscel~ Domes,~ Acco~     0    180
&gt; # ... with 5 more variables: balance &lt;dbl&gt;, weekday &lt;ord&gt;, month &lt;ord&gt;,
&gt; #   quarter &lt;fct&gt;, rsf &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="external-auditors.html#cb494-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb494-2"><a href="external-auditors.html#cb494-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">data =</span> <span class="sc">-</span><span class="fu">c</span>(name)) <span class="sc">%&gt;%</span> </span>
<span id="cb494-3"><a href="external-auditors.html#cb494-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">max_sales =</span> <span class="fu">map</span>(data, <span class="sc">~</span><span class="fu">max</span>(.x[<span class="st">&#39;credit&#39;</span>]))) <span class="sc">%&gt;%</span> </span>
<span id="cb494-4"><a href="external-auditors.html#cb494-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(max_sales)</span></code></pre></div>
<pre><code>&gt; # A tibble: 54 x 3
&gt;    name                                    data               max_sales
&gt;    &lt;chr&gt;                                   &lt;list&gt;                 &lt;dbl&gt;
&gt;  1 Baker&#39;s Professional Lighting:Store #25 &lt;tbl_df [10 x 13]&gt;      600 
&gt;  2 Godwin Lighting Depot:Store #202        &lt;tbl_df [19 x 13]&gt;     2375 
&gt;  3 Miscellaneous - Retail:Ms. Jann Minor   &lt;tbl_df [6 x 13]&gt;       350 
&gt;  4 Miscellaneous - Retail:Brian Stern      &lt;tbl_df [6 x 13]&gt;       300 
&gt;  5 Miscellaneous - Retail:Alison Johnson   &lt;tbl_df [4 x 13]&gt;       400 
&gt;  6 Cole Home Builders:Phase 2 - Lot 5      &lt;tbl_df [81 x 13]&gt;     1890 
&gt;  7 Kern Lighting Warehouse:Store #34       &lt;tbl_df [21 x 13]&gt;     8400 
&gt;  8 Godwin Lighting Depot:Store #303        &lt;tbl_df [38 x 13]&gt;      585 
&gt;  9 Thompson Lighting Stores:Store #15      &lt;tbl_df [27 x 13]&gt;     2170 
&gt; 10 Cole Home Builders:Phase 1 - Lot 2      &lt;tbl_df [17 x 13]&gt;      367.
&gt; # ... with 44 more rows</code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="external-auditors.html#cb496-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb496-2"><a href="external-auditors.html#cb496-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">split</span>(.<span class="sc">$</span>name) <span class="sc">%&gt;%</span> </span>
<span id="cb496-3"><a href="external-auditors.html#cb496-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(<span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>credit)) <span class="sc">%&gt;%</span> </span>
<span id="cb496-4"><a href="external-auditors.html#cb496-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span></code></pre></div>
<pre><code>&gt;                                                       .
&gt; Baker&#39;s Professional Lighting:Store #05           850.0
&gt; Baker&#39;s Professional Lighting:Store #10          3432.0
&gt; Baker&#39;s Professional Lighting:Store #15           600.0
&gt; Baker&#39;s Professional Lighting:Store #20           630.0
&gt; Baker&#39;s Professional Lighting:Store #25           600.0
&gt; Cole Home Builders:Phase 1 - Lot 2                367.2
&gt; Cole Home Builders:Phase 1 - Lot 4                367.2
&gt; Cole Home Builders:Phase 1 - Lot 5                367.2
&gt; Cole Home Builders:Phase 2 - Lot 5               1890.0
&gt; Dan A. North Builders:Custom Order - Suite 100A  7000.0
&gt; Dan A. North Builders:McCarthy Properties        4500.0
&gt; Dan A. North Builders:Turner Suites              5000.0
&gt; Dan A. North Builders:Wagner Suites              2975.0
&gt; Godwin Lighting Depot:Store #1020                 585.0
&gt; Godwin Lighting Depot:Store #202                 2375.0
&gt; Godwin Lighting Depot:Store #303                  585.0
&gt; Godwin Lighting Depot:Store #404                  585.0
&gt; Godwin Lighting Depot:Store #909                  585.0
&gt; Kern Lighting Warehouse:Store #01                7875.0
&gt; Kern Lighting Warehouse:Store #13               12600.0
&gt; Kern Lighting Warehouse:Store #34                8400.0
&gt; Kern Lighting Warehouse:Store #45                5600.0
&gt; Lavery Lighting &amp; Design:Store #JL-01            1020.0
&gt; Lavery Lighting &amp; Design:Store #JL-04            2500.0
&gt; Lavery Lighting &amp; Design:Store #JL-06            1860.0
&gt; Lavery Lighting &amp; Design:Store #JL-08            1275.0
&gt; Miscellaneous - Retail:Alison Johnson             400.0
&gt; Miscellaneous - Retail:Anne Loomis                680.0
&gt; Miscellaneous - Retail:Brian Stern                300.0
&gt; Miscellaneous - Retail:Carlos Nazar               620.0
&gt; Miscellaneous - Retail:David Lo                   650.0
&gt; Miscellaneous - Retail:Doug Jacobsen              900.0
&gt; Miscellaneous - Retail:Jann Minor                 975.0
&gt; Miscellaneous - Retail:Jason Helper               700.0
&gt; Miscellaneous - Retail:John Huhn                 1275.0
&gt; Miscellaneous - Retail:Lara Gussman               748.0
&gt; Miscellaneous - Retail:Melanie Hall               500.0
&gt; Miscellaneous - Retail:Mr. Fred Kaseman           620.0
&gt; Miscellaneous - Retail:Mr. Jay Jessen             975.0
&gt; Miscellaneous - Retail:Mrs. Anne Hemp             600.0
&gt; Miscellaneous - Retail:Mrs. Chris Holly           500.0
&gt; Miscellaneous - Retail:Ms. Jann Minor             350.0
&gt; Miscellaneous - Retail:Peter Karpas               680.0
&gt; Miscellaneous - Retail:Ruth Kuver                 650.0
&gt; Miscellaneous - Retail:Sean Martin                750.0
&gt; Miscellaneous - Retail:Valesha Jones              945.0
&gt; Stern Commercial Contractor&#39;s:Tittle Properties  6300.0
&gt; Stern Commercial Contractor&#39;s:Walker Properties  8100.0
&gt; Stern Commercial Contractor&#39;s:Wilson Suites      6300.0
&gt; Thompson Lighting Stores:Store #15               2170.0
&gt; Thompson Lighting Stores:Store #20                475.0
&gt; Thompson Lighting Stores:Store #30                475.0
&gt; Thompson Lighting Stores:Store #40                475.0
&gt; Thompson Lighting Stores:Store #50                475.0</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="external-auditors.html#cb498-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb498-2"><a href="external-auditors.html#cb498-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb498-3"><a href="external-auditors.html#cb498-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">cumany</span>(credit <span class="sc">&gt;</span> <span class="dv">5000</span>)) <span class="sc">%&gt;%</span>                              </span>
<span id="cb498-4"><a href="external-auditors.html#cb498-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">range_credit =</span> <span class="fu">range</span>(credit)) </span></code></pre></div>
<pre><code>&gt; # A tibble: 16 x 2
&gt; # Groups:   name [8]
&gt;    name                                            range_credit
&gt;    &lt;chr&gt;                                                  &lt;dbl&gt;
&gt;  1 Dan A. North Builders:Custom Order - Suite 100A         7000
&gt;  2 Dan A. North Builders:Custom Order - Suite 100A         7000
&gt;  3 Kern Lighting Warehouse:Store #01                         75
&gt;  4 Kern Lighting Warehouse:Store #01                       7875
&gt;  5 Kern Lighting Warehouse:Store #13                          0
&gt;  6 Kern Lighting Warehouse:Store #13                      12600
&gt;  7 Kern Lighting Warehouse:Store #34                         58
&gt;  8 Kern Lighting Warehouse:Store #34                       8400
&gt;  9 Kern Lighting Warehouse:Store #45                         55
&gt; 10 Kern Lighting Warehouse:Store #45                       5600
&gt; 11 Stern Commercial Contractor&#39;s:Tittle Properties          198
&gt; 12 Stern Commercial Contractor&#39;s:Tittle Properties         6300
&gt; 13 Stern Commercial Contractor&#39;s:Walker Properties         1350
&gt; 14 Stern Commercial Contractor&#39;s:Walker Properties         8100
&gt; 15 Stern Commercial Contractor&#39;s:Wilson Suites             5760
&gt; 16 Stern Commercial Contractor&#39;s:Wilson Suites             6300</code></pre>
<p>Perform the customer churn analysis and identify one time customers based on specific characteristics.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="external-auditors.html#cb500-1" aria-hidden="true" tabindex="-1"></a>revenue <span class="sc">%&gt;%</span> </span>
<span id="cb500-2"><a href="external-auditors.html#cb500-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, name, credit) <span class="sc">%&gt;%</span> </span>
<span id="cb500-3"><a href="external-auditors.html#cb500-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> lubridate<span class="sc">::</span><span class="fu">ceiling_date</span>(date, <span class="st">&quot;day&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb500-4"><a href="external-auditors.html#cb500-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb500-5"><a href="external-auditors.html#cb500-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">revenue =</span> <span class="fu">sum</span>(credit),</span>
<span id="cb500-6"><a href="external-auditors.html#cb500-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">last_visit =</span> <span class="fu">last</span>(date),</span>
<span id="cb500-7"><a href="external-auditors.html#cb500-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">last_days =</span>  <span class="fu">as.double</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2018-12-31&quot;</span>) <span class="sc">-</span> last_visit),</span>
<span id="cb500-8"><a href="external-auditors.html#cb500-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">orders =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb500-9"><a href="external-auditors.html#cb500-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(date, credit)) <span class="sc">%&gt;%</span> </span>
<span id="cb500-10"><a href="external-auditors.html#cb500-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(last_visit, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb500-11"><a href="external-auditors.html#cb500-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(last_days, orders, <span class="at">size =</span> revenue)) <span class="sc">+</span></span>
<span id="cb500-12"><a href="external-auditors.html#cb500-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb500-13"><a href="external-auditors.html#cb500-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span> (name, <span class="st">&quot; | &quot;</span>, last_visit)), </span>
<span id="cb500-14"><a href="external-auditors.html#cb500-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">vjust =</span> <span class="dv">1</span>, </span>
<span id="cb500-15"><a href="external-auditors.html#cb500-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb500-16"><a href="external-auditors.html#cb500-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">&quot;/days&quot;</span>)) <span class="sc">+</span></span>
<span id="cb500-17"><a href="external-auditors.html#cb500-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">paste0</span>(x, <span class="st">&quot;/orders&quot;</span>)) <span class="sc">+</span></span>
<span id="cb500-18"><a href="external-auditors.html#cb500-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">name =</span> <span class="st">&quot;Revenue&quot;</span>, <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb500-19"><a href="external-auditors.html#cb500-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb500-20"><a href="external-auditors.html#cb500-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.justification =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb500-21"><a href="external-auditors.html#cb500-21" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.95</span>, <span class="fl">0.95</span>),</span>
<span id="cb500-22"><a href="external-auditors.html#cb500-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb500-23"><a href="external-auditors.html#cb500-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="external-auditors.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prcomp()</span></span></code></pre></div>
</div>
</div>
<div id="substantive-test" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> Substantive test</h2>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="external-auditors.html#cb502-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb502-2"><a href="external-auditors.html#cb502-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(subaccount <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Revenue&quot;</span>, <span class="st">&quot;Accounts Receivable&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb502-3"><a href="external-auditors.html#cb502-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(subaccount, month) <span class="sc">%&gt;%</span> </span>
<span id="cb502-4"><a href="external-auditors.html#cb502-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(debit, credit), sum) <span class="sc">%&gt;%</span> </span>
<span id="cb502-5"><a href="external-auditors.html#cb502-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">amt =</span> <span class="fu">case_when</span>(subaccount <span class="sc">==</span> <span class="st">&quot;Accounts Receivable&quot;</span> <span class="sc">~</span> debit <span class="sc">-</span> credit,</span>
<span id="cb502-6"><a href="external-auditors.html#cb502-6" aria-hidden="true" tabindex="-1"></a>                         subaccount <span class="sc">==</span> <span class="st">&quot;Revenue&quot;</span> <span class="sc">~</span> credit <span class="sc">-</span> debit)) <span class="sc">%&gt;%</span> </span>
<span id="cb502-7"><a href="external-auditors.html#cb502-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(month, amt, <span class="at">color =</span> subaccount)) <span class="sc">+</span></span>
<span id="cb502-8"><a href="external-auditors.html#cb502-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb502-9"><a href="external-auditors.html#cb502-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">group =</span> subaccount), <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb502-10"><a href="external-auditors.html#cb502-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb502-11"><a href="external-auditors.html#cb502-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">30000</span>, <span class="dv">80000</span>, <span class="dv">10000</span>), <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">comma_format</span>()) <span class="sc">+</span></span>
<span id="cb502-12"><a href="external-auditors.html#cb502-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb502-13"><a href="external-auditors.html#cb502-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Monthly movement for FY2018&quot;</span>, </span>
<span id="cb502-14"><a href="external-auditors.html#cb502-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="cn">NULL</span>,</span>
<span id="cb502-15"><a href="external-auditors.html#cb502-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>, </span>
<span id="cb502-16"><a href="external-auditors.html#cb502-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;&quot;</span>)                                                    </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-213-1.png" width="672" /></p>
<div id="reconcilation" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Reconcilation</h3>
<p>Reconcile revenue to account receivables as of year end. Ensure that sub ledger agrees to GL by check total and cross check.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="external-auditors.html#cb503-1" aria-hidden="true" tabindex="-1"></a>gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb503-2"><a href="external-auditors.html#cb503-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(subaccount <span class="sc">==</span> <span class="st">&quot;Accounts Receivable&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb503-3"><a href="external-auditors.html#cb503-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(debit, credit), sum), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)             </span></code></pre></div>
<pre><code>&gt; # A tibble: 1 x 2
&gt;     debit  credit
&gt;     &lt;dbl&gt;   &lt;dbl&gt;
&gt; 1 408310. 375976.</code></pre>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="external-auditors.html#cb505-1" aria-hidden="true" tabindex="-1"></a>reconcilation <span class="ot">&lt;-</span> gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb505-2"><a href="external-auditors.html#cb505-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(subaccount <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Revenue&quot;</span>, <span class="st">&quot;Accounts Receivable&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb505-3"><a href="external-auditors.html#cb505-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name, subaccount) <span class="sc">%&gt;%</span> </span>
<span id="cb505-4"><a href="external-auditors.html#cb505-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(debit, credit), sum), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb505-5"><a href="external-auditors.html#cb505-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">confirmation =</span> <span class="fu">ifelse</span>(subaccount <span class="sc">==</span> <span class="st">&quot;Revenue&quot;</span>, credit <span class="sc">-</span> debit, debit <span class="sc">-</span> credit)) <span class="sc">%&gt;%</span> </span>
<span id="cb505-6"><a href="external-auditors.html#cb505-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(subaccount, confirmation, <span class="at">fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb505-7"><a href="external-auditors.html#cb505-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">client =</span> <span class="fu">word</span>(name))</span>
<span id="cb505-8"><a href="external-auditors.html#cb505-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb505-9"><a href="external-auditors.html#cb505-9" aria-hidden="true" tabindex="-1"></a>reconcilation <span class="sc">%&gt;%</span> </span>
<span id="cb505-10"><a href="external-auditors.html#cb505-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="st">&quot;Client&quot;</span> <span class="ot">=</span> client) <span class="sc">%&gt;%</span> </span>
<span id="cb505-11"><a href="external-auditors.html#cb505-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">c</span>(Revenue, <span class="st">`</span><span class="at">Accounts Receivable</span><span class="st">`</span>), sum), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb505-12"><a href="external-auditors.html#cb505-12" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">adorn_totals</span>()</span></code></pre></div>
<pre><code>&gt;         Client   Revenue Accounts Receivable
&gt;        Baker&#39;s  22669.48            12102.48
&gt;           Cole  44225.00                0.00
&gt;            Dan  37119.00             3500.00
&gt;         Godwin  31699.85                0.00
&gt;           Kern 137953.60             2222.50
&gt;         Lavery  24996.60             2708.10
&gt;  Miscellaneous  33103.00                0.00
&gt;          Stern  53118.00                0.00
&gt;       Thompson  26925.00            11800.00
&gt;          Total 411809.53            32333.08</code></pre>
</div>
<div id="aging-report" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Aging report</h3>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="external-auditors.html#cb507-1" aria-hidden="true" tabindex="-1"></a>age_customer <span class="ot">&lt;-</span> reconcilation <span class="sc">%&gt;%</span> </span>
<span id="cb507-2"><a href="external-auditors.html#cb507-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="st">`</span><span class="at">Accounts Receivable</span><span class="st">`</span> <span class="sc">!=</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb507-3"><a href="external-auditors.html#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(name)</span>
<span id="cb507-4"><a href="external-auditors.html#cb507-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb507-5"><a href="external-auditors.html#cb507-5" aria-hidden="true" tabindex="-1"></a>age_inv <span class="ot">&lt;-</span> gl_df <span class="sc">%&gt;%</span> </span>
<span id="cb507-6"><a href="external-auditors.html#cb507-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(subaccount <span class="sc">==</span> <span class="st">&quot;Accounts Receivable&quot;</span>, name <span class="sc">%in%</span> age_customer) <span class="sc">%&gt;%</span> </span>
<span id="cb507-7"><a href="external-auditors.html#cb507-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span> </span>
<span id="cb507-8"><a href="external-auditors.html#cb507-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">index =</span> <span class="fu">map</span>(debit, <span class="sc">~</span><span class="fu">case_when</span>(.x <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="dv">2</span>, </span>
<span id="cb507-9"><a href="external-auditors.html#cb507-9" aria-hidden="true" tabindex="-1"></a>                                       .x <span class="sc">==</span> credit <span class="sc">~</span> <span class="dv">1</span>)), </span>
<span id="cb507-10"><a href="external-auditors.html#cb507-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">unpaid =</span> <span class="fu">map_dbl</span>(index, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span>                   </span>
<span id="cb507-11"><a href="external-auditors.html#cb507-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(unpaid <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb507-12"><a href="external-auditors.html#cb507-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">ifelse</span>((date <span class="sc">+</span> lubridate<span class="sc">::</span><span class="fu">days</span>(<span class="dv">30</span>)) <span class="sc">&lt;</span> <span class="fu">as.Date</span>(<span class="st">&quot;2019-1-31&quot;</span>), <span class="st">&quot;Ok&quot;</span>, <span class="st">&quot;Overdue&quot;</span>)) </span></code></pre></div>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="external-auditors.html#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb508-2"><a href="external-auditors.html#cb508-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb508-3"><a href="external-auditors.html#cb508-3" aria-hidden="true" tabindex="-1"></a>age_inv <span class="sc">%&gt;%</span> </span>
<span id="cb508-4"><a href="external-auditors.html#cb508-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(account, type, date, num, name, debit, credit) <span class="sc">%&gt;%</span> </span>
<span id="cb508-5"><a href="external-auditors.html#cb508-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(debit, credit), <span class="sc">~</span> scales<span class="sc">::</span><span class="fu">comma</span>(<span class="fu">round</span>(.x)))) <span class="sc">%&gt;%</span> </span>
<span id="cb508-6"><a href="external-auditors.html#cb508-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename_with</span>(toupper) <span class="sc">%&gt;%</span> </span>
<span id="cb508-7"><a href="external-auditors.html#cb508-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">&quot;RAudit Solution LLP&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb508-8"><a href="external-auditors.html#cb508-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>, <span class="at">font_size =</span> <span class="dv">12</span>) <span class="sc">%&gt;%</span></span>
<span id="cb508-9"><a href="external-auditors.html#cb508-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;Financial Year ended as at 31/12/2018&quot;</span> <span class="ot">=</span> <span class="dv">7</span>), </span>
<span id="cb508-10"><a href="external-auditors.html#cb508-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">background =</span> <span class="st">&quot;teal&quot;</span>, <span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>, <span class="at">align =</span> <span class="st">&quot;left&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb508-11"><a href="external-auditors.html#cb508-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">column_spec</span>(<span class="dv">1</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb508-12"><a href="external-auditors.html#cb508-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collapse_rows</span>(<span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">1</span>), <span class="at">valign =</span> <span class="st">&quot;middle&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb508-13"><a href="external-auditors.html#cb508-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">footnote</span>(<span class="at">title_format =</span> <span class="fu">c</span>(<span class="st">&quot;italic&quot;</span>, <span class="st">&quot;underline&quot;</span>), </span>
<span id="cb508-14"><a href="external-auditors.html#cb508-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">general =</span> <span class="st">&quot;Please return the confirmation letter to us as soon as possible.&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="external-auditors.html#cb509-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/age_report.png&quot;</span>)</span></code></pre></div>
<p><img src="img/age_report.png" width="960" /></p>
</div>
<div id="confirmation-letter" class="section level3" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Confirmation letter</h3>
<p>Produce confirmation letters for all customers with due account receivable amount in one go.</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="external-auditors.html#cb510-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(<span class="at">customer =</span> <span class="fu">unique</span>(age_inv<span class="sc">$</span>name),</span>
<span id="cb510-2"><a href="external-auditors.html#cb510-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">filename =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="fu">paste0</span>(<span class="st">&quot;confirmation/&quot;</span>, <span class="st">&quot;confirmation_&quot;</span>, <span class="fu">seq</span>(<span class="fu">length</span>(<span class="fu">unique</span>(age_inv<span class="sc">$</span>name))), <span class="st">&quot;.html&quot;</span>)),</span>
<span id="cb510-3"><a href="external-auditors.html#cb510-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">params =</span> <span class="fu">map</span>(customer, <span class="sc">~</span> <span class="fu">list</span>(<span class="at">customer =</span> .))) <span class="sc">%&gt;%</span> </span>
<span id="cb510-4"><a href="external-auditors.html#cb510-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">output_file =</span> filename, params) <span class="sc">%&gt;%</span> </span>
<span id="cb510-5"><a href="external-auditors.html#cb510-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pwalk</span>(rmarkdown<span class="sc">::</span>render, <span class="at">input =</span> here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;confirmation/confirmation.Rmd&quot;</span>), <span class="st">&quot;html_document&quot;</span>, <span class="at">envir =</span> <span class="fu">new.env</span>())</span>
<span id="cb510-6"><a href="external-auditors.html#cb510-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-7"><a href="external-auditors.html#cb510-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb510-8"><a href="external-auditors.html#cb510-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">&quot;confirmation/&quot;</span>, <span class="fu">list.files</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;confirmation&quot;</span>), <span class="st">&quot;*.html&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb510-9"><a href="external-auditors.html#cb510-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(file.remove)</span></code></pre></div>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="external-auditors.html#cb511-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/confirm_letter.png&quot;</span>)</span></code></pre></div>
<p><img src="img/confirm_letter.png" width="960" /></p>
</div>
</div>
<div id="reporting" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Reporting</h2>
<p>Audit report needs to be filled up with numbers after finalized draft financial statements.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="external-auditors.html#cb512-1" aria-hidden="true" tabindex="-1"></a>fload <span class="ot">&lt;-</span> <span class="cf">function</span>(df, cell){</span>
<span id="cb512-2"><a href="external-auditors.html#cb512-2" aria-hidden="true" tabindex="-1"></a>  pos <span class="ot">&lt;-</span> <span class="fu">strsplit</span>(cell, <span class="at">split =</span> <span class="st">&#39;_&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">unlist</span>() </span>
<span id="cb512-3"><a href="external-auditors.html#cb512-3" aria-hidden="true" tabindex="-1"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb512-4"><a href="external-auditors.html#cb512-4" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(table <span class="sc">==</span> pos[<span class="dv">1</span>], <span class="fu">row_number</span>() <span class="sc">==</span> pos[<span class="dv">2</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb512-5"><a href="external-auditors.html#cb512-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(pos[<span class="dv">3</span>]) <span class="sc">%&gt;%</span> </span>
<span id="cb512-6"><a href="external-auditors.html#cb512-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>()</span>
<span id="cb512-7"><a href="external-auditors.html#cb512-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="external-auditors.html#cb513-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">head</span>(mtcars) <span class="sc">%&gt;%</span> </span>
<span id="cb513-2"><a href="external-auditors.html#cb513-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&#39;car&#39;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb513-3"><a href="external-auditors.html#cb513-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">table =</span> <span class="st">&#39;table1&#39;</span>)                                              </span></code></pre></div>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="external-auditors.html#cb514-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;img/audit_report.png&quot;</span>)</span></code></pre></div>
<p><img src="img/audit_report.png" width="960" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="fpa.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="utilities.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-audit.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
